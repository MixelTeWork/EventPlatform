"use strict";(self.webpackChunkevent_platform=self.webpackChunkevent_platform||[]).push([[658],{6034:(e,s,t)=>{t.r(s),t.d(s,{default:()=>$s});var n=t(7689),a=t(1933);class l extends Error{}async function i(e,s,t){const n=await fetch(s,{method:e,headers:{"Content-Type":"application/json"},body:void 0===t?null:JSON.stringify(t)});if(!n.ok)throw new l((await n.json()).msg);return n}function r(e,s){return i("POST",e,s)}function c(e,s){return i("DELETE",e,s)}async function o(e,s,t){const n=await i(e,s,t);return await n.json()}function d(e,s){return o("GET",e,s)}function u(e,s){return o("POST",e,s)}function m(){return(0,a.useQuery)("user",h)}async function h(){const e=await fetch("/api/user"),s=await e.json();if(401==e.status)return{auth:!1,id:"",balance:0,roles:[],name:"",last_name:"",photo:"",operations:[]};if(!e.ok)throw new l(s.msg);const t=s;return t.auth=!0,t}function v(e,s){var t,n;return!(null===(t=e.data)||void 0===t||!t.auth||null===(n=e.data)||void 0===n||!n.operations.includes(s))}function x(e){return v(m(),e)}var _=t(5086),j=t(2791);function g(){const{pathname:e}=(0,n.TH)();return(0,j.useEffect)((()=>{window.scrollTo(0,0)}),[e]),null}var y=t(184);function p(e,s){const t=e instanceof l?e.message:"\u041e\u0448\u0438\u0431\u043a\u0430";return s?s(t):t}function b(e,s,t){if(!e.isError)return null;return(s||A)(p(e.error,t))}function A(e){return(0,y.jsx)("h3",{style:{color:"tomato",textAlign:"center"},children:e})}function f(){for(var e=arguments.length,s=new Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter((e=>!!e)).join(" ")}const N={root:"styles_root__hzHjz",visible:"styles_visible__6aD-n",close:"styles_close__3L8iW",message:"styles_message__oF8zk"};let w="";function k(){const[e,s]=(0,j.useState)("");return(0,j.useEffect)((()=>{const e=setInterval((()=>{const e=function(e){let s=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return s?decodeURIComponent(s[1]):void 0}("MESSAGE_TO_FRONTEND");e!=w&&(w=e||"",s(w))}),1e3);return()=>{clearInterval(e)}}),[s]),(0,y.jsxs)("div",{className:f(N.root,""!=e&&N.visible),children:[(0,y.jsx)("button",{className:N.close,onClick:()=>s("")}),(0,y.jsx)("div",{className:N.message,children:E(e)})]})}function E(e){return'"'==e.at(0)&&(e=e.slice(1)),'"'==e.at(-1)&&(e=e.slice(0,-1)),e}const C={root:"styles_root__4DGhY"};function S(){const e=(0,n.s0)();return(0,y.jsx)("div",{className:C.root,children:(0,y.jsx)("button",{onClick:()=>e(-1),className:"button button_light",children:"\u041d\u0430\u0437\u0430\u0434"})})}var I=t(1087);const R={root:"styles_root__Zvl9c",home:"styles_home__o+-s7",block:"styles_block__a1SM7",balance:"styles_balance__PLLCC",user:"styles_user__0ltHf",img:"styles_img__vhWmb",menu:"styles_menu__WWgPh",menuVisible:"styles_menuVisible__mMGZn"};async function F(e){const s=await u("/api/auth",e);return s.auth=!0,s}async function q(){await r("/api/logout")}const Q={root:"styles_root__BdzzK",spinner:"styles_spinner__rlI86","lds-ring":"styles_lds-ring__jnLuB"};function U(e){let{color:s,zIndex:t,block:n,r:a=0}=e;return(0,y.jsx)("div",{className:Q.root,style:{position:n?"absolute":"fixed",borderRadius:a},children:(0,y.jsxs)("div",{className:Q.spinner,style:{"--color":s,zIndex:t},children:[(0,y.jsx)("div",{}),(0,y.jsx)("div",{}),(0,y.jsx)("div",{}),(0,y.jsx)("div",{})]})})}function M(){return(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 -960 960 960",height:"1em",width:"1em",fill:"currentColor",children:(0,y.jsx)("path",{d:"M240-200h120v-200q0-17 11.5-28.5T400-440h160q17 0 28.5 11.5T600-400v200h120v-360L480-740 240-560v360Zm-80 0v-360q0-19 8.5-36t23.5-28l240-180q21-16 48-16t48 16l240 180q15 11 23.5 28t8.5 36v360q0 33-23.5 56.5T720-120H560q-17 0-28.5-11.5T520-160v-200h-80v200q0 17-11.5 28.5T400-120H240q-33 0-56.5-23.5T160-200Zm320-270Z"})})}function B(e){var s,t,l,i;let{color:r="#042e40",homeBtn:c=!1}=e;const[o,d]=(0,j.useState)(!1),u=(0,n.s0)(),h=function(e){const s=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:q,onSuccess:()=>{s.setQueryData("user",(e=>({auth:!1,id:"",balance:0,roles:[],name:"",last_name:"",photo:"",operations:[]}))),null===e||void 0===e||e()}})}((()=>{d(!1)})),x=m();return(0,y.jsxs)("div",{className:R.root,style:{background:r},children:[(0,y.jsx)(I.rU,{to:"/",className:R.home,children:c&&(0,y.jsx)(M,{})}),(0,y.jsxs)("span",{className:R.block,children:[(0,y.jsxs)("div",{className:R.balance,children:[(null===(s=x.data)||void 0===s?void 0:s.balance)||0," G"]}),(0,y.jsxs)("button",{className:R.user,onClick:()=>{var e;return null!==(e=x.data)&&void 0!==e&&e.auth?d((e=>!e)):u("/")},children:[(0,y.jsx)("span",{children:null!==(t=x.data)&&void 0!==t&&t.auth?null===(l=x.data)||void 0===l?void 0:l.name:"\u0412\u043e\u0439\u0442\u0438"}),(null===(i=x.data)||void 0===i?void 0:i.photo)&&(0,y.jsx)("img",{className:R.img,src:x.data.photo,alt:"avatar"})]}),(0,y.jsxs)("div",{className:f(R.menu,o&&R.menuVisible),style:{background:r},children:[v(x,"page_debug")&&(0,y.jsx)(I.rU,{to:"/debug",children:"</>"}),v(x,"page_worker")&&(0,y.jsx)(I.rU,{to:"/worker",children:"[-^-]"}),(0,y.jsx)("button",{onClick:()=>h.mutate(),disabled:"idle"!=h.status,children:"\u0412\u044b\u0439\u0442\u0438"})]})]}),"loading"==h.status&&(0,y.jsx)(U,{})]})}const T={root:"styles_root__xvR2N",hasFooter:"styles_hasFooter__lMS3o",body:"styles_body__S-p4X",body_centered:"styles_body_centered__NzRPU",body_centeredPage:"styles_body_centeredPage__R-EzO"};function L(e){let{children:s,className:t,headerColor:n,homeBtn:a=!1,styles:l,centered:i=!1,centeredPage:r=!1,height100:c=!1,gap:o=0,header:d,footer:u}=e;return void 0===d&&(d=(0,y.jsx)(B,{color:n,homeBtn:a})),(0,y.jsxs)("div",{className:f(T.root,!!u&&T.hasFooter),style:{...l,maxHeight:c?"100dvh":""},children:[d||(0,y.jsx)("div",{}),(0,y.jsx)("div",{className:f(T.body,t,i&&T.body_centered,r&&T.body_centeredPage),style:{gap:o,maxHeight:c?"100%":""},children:s}),u]})}function D(){return(0,y.jsx)(L,{centered:!0,header:(0,y.jsx)(S,{}),children:"\u0422\u0430\u043a\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u043d\u0435\u0442"})}function P(){return(0,y.jsx)(L,{centered:!0,header:(0,y.jsx)(S,{}),children:"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u043f\u0440\u0430\u0432 \u043d\u0430 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b"})}const J={back:"styles_back__uuJZO",form:"styles_form__n7Rcu"};function X(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Underparty";(0,j.useEffect)((()=>{const t=document.title,n="object"!=typeof e?[e]:e;return document.title=[s,...n].filter((e=>!!e)).join(" | "),()=>{document.title=t}}),[e,s])}const V={form:"styles_form__cFFCH",field:"styles_field__5rpBk"};function O(e){let{className:s,style:t,onSubmit:n,children:a}=e;const l=(0,j.useRef)(null);return(0,y.jsx)("form",{className:f(V.form,s),style:t,ref:l,onSubmit:e=>{if(e.preventDefault(),!l.current)return;const s=new FormData(l.current);n(s)},children:a})}function Z(e){let{label:s,className:t,style:n,children:a}=e;return(0,y.jsxs)("label",{className:f(V.field,t),style:n,children:[(0,y.jsx)("span",{children:s}),a]})}function G(){X("\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f");const[e,s]=(0,j.useState)(""),t=(0,j.useRef)(null),n=(0,j.useRef)(null),i=function(e){const s=(0,a.useQueryClient)(),t=(0,a.useMutation)({mutationFn:F,onSuccess:e=>{s.setQueryData("user",(()=>e))},onError:s=>{null===e||void 0===e||e(s instanceof l?s.message:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437")}});return t}(s);return(0,y.jsxs)(L,{header:null,centered:!0,centeredPage:!0,gap:"2em",children:[(0,y.jsx)(I.rU,{to:"/",className:f(J.back,"material_symbols"),children:"arrow_back"}),(0,y.jsx)("h1",{children:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"}),e&&(0,y.jsx)("h3",{children:e}),i.isLoading&&(0,y.jsx)(U,{}),(0,y.jsxs)(O,{className:J.form,onSubmit:function(){var e,s;const a=(null===(e=t.current)||void 0===e?void 0:e.value)||"",l=(null===(s=n.current)||void 0===s?void 0:s.value)||"";i.mutate({login:a,password:l})},children:[(0,y.jsx)(Z,{label:"\u041b\u043e\u0433\u0438\u043d",children:(0,y.jsx)("input",{ref:t,type:"text",name:"login",required:!0})}),(0,y.jsx)(Z,{label:"\u041f\u0430\u0440\u043e\u043b\u044c",children:(0,y.jsx)("input",{ref:n,type:"password",name:"password",required:!0})}),(0,y.jsx)("button",{type:"submit",className:"button button_light button_small",disabled:"loading"==i.status,children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}const z={root:"styles_root__7P05R"},H={root:"styles_root__O0923",hidden:"styles_hidden__eYJaf",open:"styles_open__35Vcu",popup:"styles_popup__L-0H0",header:"styles_header__o87wG",close:"styles_close__w0Yhz",body:"styles_body__t75Nd"};function W(e){let{children:s,open:t=!1,close:n,title:a="",closeOnOutclick:l=!1}=e;const i=(0,j.useRef)(null),[r,c]=(0,j.useState)(t),[o,d]=(0,j.useState)(!t);return(0,j.useEffect)((()=>{if(t){d(!1);const e=setTimeout((()=>c(!0)),100);return()=>clearTimeout(e)}c(!1);const e=setTimeout((()=>d(!0)),250);return()=>clearTimeout(e)}),[t]),(0,y.jsx)("div",{ref:i,className:f(H.root,r&&H.open,o&&H.hidden),onClick:e=>{l&&e.target==i.current&&(null===n||void 0===n||n())},children:(0,y.jsxs)("div",{className:H.popup,children:[(a||n)&&(0,y.jsxs)("div",{className:H.header,children:[(0,y.jsx)("h3",{children:a}),n&&(0,y.jsx)("button",{className:H.close,onClick:n})]}),(0,y.jsx)("div",{className:H.body,children:s})]})})}function Y(){const[e,s]=(0,j.useState)(""),[t,n]=(0,j.useState)(""),a=(0,j.useRef)(null),l=(0,j.useRef)(null);return(0,y.jsxs)(L,{centered:!0,gap:"1rem",className:z.root,homeBtn:!0,children:[(0,y.jsx)(I.rU,{to:"/users",children:"Users"}),(0,y.jsx)(I.rU,{to:"/log",children:"Log"}),(0,y.jsx)("button",{onClick:async()=>{s("Loading");try{const e=await fetch("/api/debug/log_errors"),t=await e.text();s(t),setTimeout((()=>{var e,s,t,n;return null===(e=a.current)||void 0===e||null===(s=e.parentElement)||void 0===s?void 0:s.scrollTo(0,null===(t=a.current)||void 0===t||null===(n=t.parentElement)||void 0===n?void 0:n.scrollHeight)}),150)}catch(e){s(JSON.stringify(e))}},children:"Log errors"}),(0,y.jsx)("button",{onClick:async()=>{n("Loading");try{const e=await fetch("/api/debug/log_info"),s=await e.text();n(s),setTimeout((()=>{var e,s,t,n;return null===(e=l.current)||void 0===e||null===(s=e.parentElement)||void 0===s?void 0:s.scrollTo(0,null===(t=l.current)||void 0===t||null===(n=t.parentElement)||void 0===n?void 0:n.scrollHeight)}),150)}catch(e){n(JSON.stringify(e))}},children:"Log requests"}),(0,y.jsx)(W,{title:"logErrors",open:""!=e,close:()=>s(""),children:(0,y.jsx)("pre",{ref:a,children:e})}),(0,y.jsx)(W,{title:"log",open:""!=t,close:()=>n(""),children:(0,y.jsx)("pre",{ref:l,children:t})})]})}const K={root:"styles_root__h8xNs",auth:"styles_auth__quDS1",img:"styles_img__jUWp9",title:"styles_title__+su+v",btn:"styles_btn__xIQ7b"},$=t.p+"static/media/city.10ddee993980b103bc6c.png",ee="https://oauth.vk.com/authorize?client_id=".concat("51848582","&redirect_uri=").concat("https://www.underparty.fun/auth_vk","&display=page&response_type=code");function se(){return(0,y.jsxs)("div",{className:K.root,children:[(0,y.jsx)(I.rU,{to:"/auth",className:K.auth}),(0,y.jsxs)("div",{className:K.title,children:[(0,y.jsx)("img",{className:K.img,src:$,alt:"\u0413\u043e\u0440\u043e\u0434"}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h1",{children:"Underparty"}),(0,y.jsx)("h2",{children:"18.02.24"})]})]}),(0,y.jsx)("a",{className:K.btn,href:ee,children:"\u0412\u0445\u043e\u0434"})]})}function te(e){const s=e;return s.date=new Date(e.date),s}function ne(e,s){return"".concat(e).padStart(s,"0")}function ae(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(e){return e?arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"".concat(e.getFullYear(),".").concat(ne(e.getMonth()+1,2),".").concat(ne(e.getDate(),2)):"".concat(ne(e.getDate(),2),".").concat(ne(e.getMonth()+1,2),".").concat(e.getFullYear()):""}(e,arguments.length>2&&void 0!==arguments[2]&&arguments[2])+" "+function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t="".concat(ne(e.getHours(),2),":").concat(ne(e.getMinutes(),2));return s?t+":".concat(ne(e.getSeconds(),2)):t}(e,s)}const le={table:"styles_table__QLr-h",changesCell:"styles_changesCell__0wQDJ",changes:"styles_changes__EyS9f",btn:"styles_btn__H7b72"};function ie(){var e;X("Log");const s=(0,a.useQuery)("log",(async()=>(await d("/api/debug/log")).map(te)));return(0,y.jsxs)(L,{centeredPage:!0,styles:{fontFamily:"'PT Sans', Arial"},homeBtn:!0,children:[s.isFetching&&(0,y.jsx)("h3",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),b(s),!s.isFetching&&(0,y.jsx)("button",{className:le.btn,onClick:()=>s.refetch(),children:"Update"}),(0,y.jsxs)("table",{className:le.table,children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{style:{minWidth:"9.5em"},children:"Date"}),(0,y.jsx)("th",{style:{minWidth:"4em"},children:"Action"}),(0,y.jsx)("th",{style:{minWidth:"9.5em"},children:"Table[id]"}),(0,y.jsx)("th",{children:"User[id]"}),(0,y.jsx)("th",{style:{width:"18em"},children:"Changes"})]})}),(0,y.jsx)("tbody",{children:null===(e=s.data)||void 0===e?void 0:e.map((e=>(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:ae(e.date,!0,!0)}),(0,y.jsx)("td",{children:re(e.actionCode)}),(0,y.jsxs)("td",{children:[e.tableName,"[",e.recordId,"]"]}),(0,y.jsxs)("td",{children:[e.userName," [",e.userId,"]"]}),(0,y.jsx)("td",{className:le.changesCell,children:(0,y.jsxs)("div",{className:le.changes,children:[(0,y.jsx)("input",{type:"checkbox",className:le.toggleInp,id:"item".concat(e.id)}),(0,y.jsx)("div",{children:e.changes.map((e=>(0,y.jsxs)("div",{children:[e[0],": ",JSON.stringify(e[1])," ","->"," ",JSON.stringify(e[2])]},e[0])))}),e.changes.length>0&&(0,y.jsx)("label",{className:le.btn,htmlFor:"item".concat(e.id),children:e.changes.length})]})})]},e.id)))})]})]})}function re(e){return(0,y.jsx)("span",{style:{color:{added:"#008000",deleted:"#b30000",updated:"#006fb3",restored:"#990099"}[e]},children:e})}function ce(){return(0,a.useQuery)("quests_full",(async()=>await d("/api/quests_full")))}function oe(e,s,t){const n=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async()=>await c("/api/quest/".concat(e)),onSuccess:()=>{var t,a;"success"==(null===(t=n.getQueryState("quests_full"))||void 0===t?void 0:t.status)&&n.setQueryData("quests_full",(s=>(null===s||void 0===s?void 0:s.filter((s=>s.id!=e)))||[])),"success"==(null===(a=n.getQueryState("quests"))||void 0===a?void 0:a.status)&&n.invalidateQueries("quests",{exact:!0}),null===s||void 0===s||s()},onError:t})}function de(e,s){let[t,n]=(0,j.useState)(e),a=n;return s&&(a=e=>{n(e),s()}),{v:t,set:a,setT:()=>n(!0),setF:()=>n(!1)}}const ue={root:"styles_root__oNkfm",img:"styles_img__46Cxj",textarea:"styles_textarea__sNjzZ",description_count:"styles_description_count__Nnz4M",description_count_too_many:"styles_description_count_too_many__udmKa",form:"styles_form__EJp7b"};function me(e,s){const[t,n]=(0,j.useState)(e);return s?{v:t,set:e=>{n(e),s()}}:{v:t,set:n}}function he(){const e=(0,j.useRef)(null),s=(0,j.useRef)(null),t=(0,j.useRef)(null),n=me(""),l=de(!1),i=function(e,s){const t=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>await u("/api/quest",e),onSuccess:s=>{var n,a;"success"==(null===(n=t.getQueryState("quests_full"))||void 0===n?void 0:n.status)&&t.setQueryData("quests_full",(e=>e?[...e,s]:[s])),"success"==(null===(a=t.getQueryState("quests"))||void 0===a?void 0:a.status)&&(console.log("some log for testing"),t.invalidateQueries("quests",{exact:!0})),null===e||void 0===e||e(s)},onError:s})}((()=>{l.setF(),e.current&&(e.current.value=""),s.current&&(s.current.value=""),t.current&&(t.current.checked=!1),n.set("")}));return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("button",{className:ue.root,onClick:l.setT,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),(0,y.jsxs)(W,{title:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u0432\u0435\u0441\u0442\u0430",open:l.v,close:l.setF,children:[i.isLoading&&(0,y.jsx)(U,{}),b(i),(0,y.jsxs)(O,{className:ue.form,onSubmit:()=>{var a,l,r;const c=null===(a=e.current)||void 0===a?void 0:a.value,o=null===(l=s.current)||void 0===l?void 0:l.valueAsNumber,d=null===(r=t.current)||void 0===r?void 0:r.checked;c&&void 0!==o&&void 0!==d&&i.mutate({name:c,reward:o,hidden:d,description:n.v})},children:[(0,y.jsx)(Z,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",children:(0,y.jsx)("input",{ref:e,required:!0,type:"text"})}),(0,y.jsx)(Z,{label:"\u041d\u0430\u0433\u0440\u0430\u0434\u0430",children:(0,y.jsx)("input",{ref:s,required:!0,type:"number"})}),(0,y.jsx)(Z,{children:(0,y.jsxs)("label",{children:[(0,y.jsx)("input",{ref:t,type:"checkbox"}),(0,y.jsx)("span",{children:"\u0421\u043a\u0440\u044b\u0442\u044b\u0439"})]})}),(0,y.jsxs)(Z,{label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:[(0,y.jsx)("textarea",{className:ue.textarea,cols:40,rows:10,value:n.v,onChange:e=>n.set(e.target.value)}),(0,y.jsx)("div",{className:ue.description_count,children:(0,y.jsxs)("span",{children:[(0,y.jsx)("span",{className:n.v.length>256?ue.description_count_too_many:"",children:n.v.length}),(0,y.jsx)("span",{children:"/256"})]})})]}),(0,y.jsx)(Z,{children:(0,y.jsx)("button",{type:"submit",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})]})]})}const ve={button:"styles_button__MKylh"};function xe(e){let{title:s,mutationFn:t,mutatateParams:n,itemId:a,onSuccess:l,open:i,close:r}=e;const c=t(a,(e=>{null===r||void 0===r||r(),null===l||void 0===l||l(e)}));return(0,j.useEffect)((()=>{i||c.reset()}),[i]),(0,y.jsxs)(W,{open:i,close:r,title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",children:[b(c),c.isLoading&&(0,y.jsx)(U,{}),(0,y.jsxs)(O,{onSubmit:()=>{c.mutate(n)},children:[(0,y.jsx)("h2",{children:s}),(0,y.jsx)("button",{type:"submit",className:ve.button,children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c"})]})]})}const _e={root:"styles_root__RyDEO",error:"styles_error__mpo99",id:"styles_id__+YyjR",img:"styles_img__Q1dE-",inputs:"styles_inputs__+GHP-",changed:"styles_changed__-Gqjn",buttons:"styles_buttons__DpOXa",btnMinus:"styles_btnMinus__sOvku",checkbox:"styles_checkbox__3q5xK",description:"styles_description__IsQuf",textarea:"styles_textarea__DP8w4",description_count:"styles_description_count__rC08l",description_count_too_many:"styles_description_count_too_many__9Cvtl"};function je(){return(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 -960 960 960",height:"1em",width:"1em",fill:"currentColor",children:(0,y.jsx)("path",{d:"M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"})})}function ge(){return(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 -960 960 960",height:"1em",width:"1em",fill:"currentColor",children:(0,y.jsx)("path",{d:"M840-680v480q0 33-23.5 56.5T760-120H200q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h480l160 160Zm-80 34L646-760H200v560h560v-446ZM480-240q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35ZM240-560h360v-160H240v160Zm-40-86v446-560 114Z"})})}function ye(){return(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 -960 960 960",height:"1em",width:"1em",fill:"currentColor",children:(0,y.jsx)("path",{d:"m336-280 144-144 144 144 56-56-144-144 144-144-56-56-144 144-144-144-56 56 144 144-144 144 56 56ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"})})}function pe(e){let{quest:s}=e;const t=de(!1),n=de(!1),l=de(!1),i=me(s.name,t.setT),r=me(s.reward,t.setT),c=de(s.hidden,t.setT),o=me(s.description,t.setT),d=function(e,s,t){const n=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async s=>await u("/api/quest/".concat(e),s),onSuccess:e=>{var t,a;"success"==(null===(t=n.getQueryState("quests_full"))||void 0===t?void 0:t.status)&&n.setQueryData("quests_full",(s=>(null===s||void 0===s?void 0:s.map((s=>s.id==e.id?e:s)))||[])),"success"==(null===(a=n.getQueryState("quests"))||void 0===a?void 0:a.status)&&n.invalidateQueries("quests",{exact:!0}),null===s||void 0===s||s(e)},onError:t})}(s.id,m,(()=>m()));function m(e){i.set((null===e||void 0===e?void 0:e.name)||s.name),r.set((null===e||void 0===e?void 0:e.reward)||s.reward),c.set((null===e||void 0===e?void 0:e.hidden)||s.hidden),o.set((null===e||void 0===e?void 0:e.description)||s.description),t.setF()}return(0,j.useEffect)(m,[s]),(0,y.jsxs)("div",{className:f(_e.root,t.v&&_e.changed),children:[d.isLoading&&(0,y.jsx)(U,{block:!0,r:"0.5rem"}),b(d,(e=>(0,y.jsxs)("div",{className:_e.error,children:[(0,y.jsx)("div",{children:e}),(0,y.jsx)("button",{onClick:()=>d.reset(),children:"\u041e\u041a"})]}))),(0,y.jsx)(xe,{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440: "+i.v,itemId:s.id,mutationFn:oe,open:n.v,close:n.setF}),(0,y.jsx)("div",{className:_e.id,children:s.id}),(0,y.jsxs)("div",{className:_e.inputs,children:[(0,y.jsx)("div",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}),(0,y.jsx)("input",{type:"text",value:i.v,onChange:e=>i.set(e.target.value)}),(0,y.jsx)("div",{children:"\u041d\u0430\u0433\u0440\u0430\u0434\u0430"}),(0,y.jsx)("input",{type:"number",value:r.v,onChange:e=>r.set(e.target.valueAsNumber)}),(0,y.jsx)("span",{children:"\u0421\u043a\u0440\u044b\u0442\u044b\u0439"}),(0,y.jsxs)("label",{className:_e.checkbox,children:[(0,y.jsx)("input",{type:"checkbox",checked:c.v,onChange:e=>c.set(e.target.checked)}),(0,y.jsx)("span",{})]}),(0,y.jsx)("div",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),(0,y.jsx)("button",{className:f(_e.description,o.v.length>256&&_e.description_count_too_many),onClick:l.setT,children:o.v})]}),(0,y.jsxs)("div",{className:f("material_symbols",_e.buttons),children:[!t.v&&(0,y.jsx)("button",{onClick:n.setT,children:(0,y.jsx)(je,{})}),t.v&&(0,y.jsx)("button",{onClick:()=>{d.mutate({name:i.v,description:o.v,reward:r.v,hidden:c.v})},children:(0,y.jsx)(ge,{})}),t.v&&(0,y.jsx)("button",{onClick:()=>m(),children:(0,y.jsx)(ye,{})})]}),(0,y.jsxs)(W,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u0432\u0435\u0441\u0442\u0430",open:l.v,close:l.setF,children:[(0,y.jsxs)("h2",{children:["\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043a\u0432\u0435\u0441\u0442\u0430 ",i.v]}),(0,y.jsx)("textarea",{className:_e.textarea,cols:40,rows:10,value:o.v,onChange:e=>o.set(e.target.value)}),(0,y.jsx)("div",{className:_e.description_count,children:(0,y.jsxs)("span",{children:[(0,y.jsx)("span",{className:o.v.length>256?_e.description_count_too_many:"",children:o.v.length}),(0,y.jsx)("span",{children:"/256"})]})})]})]})}const be={quests:"styles_quests__lnETn"};function Ae(){var e;X("\u041a\u0432\u0435\u0441\u0442\u044b");const s=ce();return(0,y.jsxs)(L,{centeredPage:!0,gap:"0.5rem",homeBtn:!0,children:[s.isLoading&&(0,y.jsx)(U,{}),b(s),(0,y.jsx)("h1",{children:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u0432\u0435\u0441\u0442\u0430\u043c\u0438"}),(0,y.jsx)(he,{}),(0,y.jsx)("div",{className:be.quests,children:null===(e=s.data)||void 0===e?void 0:e.map((e=>(0,y.jsx)(pe,{quest:e},e.id)))})]})}function fe(){return(0,a.useQuery)("storeItemsFull",(async()=>await d("/api/store_items_full")))}function Ne(e,s,t){const n=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async()=>await u("/api/store_item/".concat(e,"/decrease")),onSuccess:e=>{var t,a;"success"==(null===(t=n.getQueryState("storeItemsFull"))||void 0===t?void 0:t.status)&&n.setQueryData("storeItemsFull",(s=>(null===s||void 0===s?void 0:s.map((s=>s.id==e.id?e:s)))||[])),"success"==(null===(a=n.getQueryState("storeItems"))||void 0===a?void 0:a.status)&&n.invalidateQueries("storeItems",{exact:!0}),null===s||void 0===s||s(e)},onError:t})}function we(e,s,t){const n=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async()=>await c("/api/store_item/".concat(e)),onSuccess:()=>{var t,a;"success"==(null===(t=n.getQueryState("storeItemsFull"))||void 0===t?void 0:t.status)&&n.setQueryData("storeItemsFull",(s=>(null===s||void 0===s?void 0:s.filter((s=>s.id!=e)))||[])),"success"==(null===(a=n.getQueryState("storeItems"))||void 0===a?void 0:a.status)&&n.invalidateQueries("storeItems",{exact:!0}),null===s||void 0===s||s()},onError:t})}const ke={root:"styles_root__yl-I8",img:"styles_img__gddIw",form:"styles_form__ASF2C"};async function Ee(e,s){const t=await new Promise((s=>{var t=new FileReader;t.addEventListener("loadend",(e=>{s({result:t.result,error:t.error})})),t.readAsDataURL(e)}));return t.error?(console.error(t.error),null):{data:t.result,name:s}}function Ce(){var e;const s=me(null),t=(0,j.useRef)(null),n=(0,j.useRef)(null),l=(0,j.useRef)(null),i=de(!1),r=function(e,s){const t=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>await u("/api/store_item",e),onSuccess:s=>{var n,a;"success"==(null===(n=t.getQueryState("storeItemsFull"))||void 0===n?void 0:n.status)&&t.setQueryData("storeItemsFull",(e=>e?[...e,s]:[s])),"success"==(null===(a=t.getQueryState("storeItems"))||void 0===a?void 0:a.status)&&t.invalidateQueries("storeItems",{exact:!0}),null===e||void 0===e||e(s)},onError:s})}((()=>{s.set(null),i.setF(),t.current&&(t.current.value=""),n.current&&(n.current.value=""),l.current&&(l.current.value="")}));return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("button",{className:ke.root,onClick:i.setT,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),(0,y.jsxs)(W,{title:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430",open:i.v,close:i.setF,children:[r.isLoading&&(0,y.jsx)(U,{}),b(r),""==(null===(e=s.v)||void 0===e?void 0:e.data)&&(0,y.jsx)(U,{}),(0,y.jsxs)(O,{className:ke.form,onSubmit:()=>{var e,a,i;const c=null===(e=t.current)||void 0===e?void 0:e.value,o=null===(a=l.current)||void 0===a?void 0:a.valueAsNumber,d=null===(i=n.current)||void 0===i?void 0:i.valueAsNumber;o&&c&&d&&r.mutate({count:o,name:c,price:d,img:s.v||void 0})},children:[(0,y.jsxs)(Z,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",children:[(0,y.jsx)("div",{className:ke.img,children:s.v&&(0,y.jsx)("img",{src:s.v.data,alt:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"})}),(0,y.jsx)("input",{type:"file",accept:"image/png, image/jpeg, image/gif",style:{display:"none"},onChange:async e=>{var t,n;s.set({data:"",name:""}),s.set(await Ee(null===(t=e.target)||void 0===t||null===(n=t.files)||void 0===n?void 0:n[0],""))}})]}),(0,y.jsx)(Z,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",children:(0,y.jsx)("input",{ref:t,required:!0,type:"text"})}),(0,y.jsx)(Z,{label:"\u0426\u0435\u043d\u0430",children:(0,y.jsx)("input",{ref:n,required:!0,type:"number"})}),(0,y.jsx)(Z,{label:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",children:(0,y.jsx)("input",{ref:l,required:!0,type:"number"})}),(0,y.jsx)(Z,{children:(0,y.jsx)("button",{type:"submit",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})]})]})}const Se={root:"styles_root__792UO",error:"styles_error__EjE0M",id:"styles_id__EvI3k",img:"styles_img__F6UZc",inputs:"styles_inputs__r6vu+",changed:"styles_changed__aaZPg",buttons:"styles_buttons__X3oNY",btnMinus:"styles_btnMinus__5ZzMA"};function Ie(e){var s,t;let{item:n}=e;const l=de(!1),i=de(!1),r=de(!1),c=me(null,l.setT),o=me(n.name,l.setT),d=me(n.count,l.setT),m=me(n.price,l.setT),h=function(e,s,t){const n=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async s=>await u("/api/store_item/".concat(e),s),onSuccess:e=>{var t,a;"success"==(null===(t=n.getQueryState("storeItemsFull"))||void 0===t?void 0:t.status)&&n.setQueryData("storeItemsFull",(s=>(null===s||void 0===s?void 0:s.map((s=>s.id==e.id?e:s)))||[])),"success"==(null===(a=n.getQueryState("storeItems"))||void 0===a?void 0:a.status)&&n.invalidateQueries("storeItems",{exact:!0}),null===s||void 0===s||s(e)},onError:t})}(n.id,v,(()=>v()));function v(e){c.set(null),o.set((null===e||void 0===e?void 0:e.name)||n.name),d.set((null===e||void 0===e?void 0:e.count)||n.count),m.set((null===e||void 0===e?void 0:e.price)||n.price),l.setF()}return(0,j.useEffect)(v,[n]),(0,y.jsxs)("div",{className:f(Se.root,l.v&&Se.changed),children:[h.isLoading&&(0,y.jsx)(U,{block:!0,r:"0.5rem"}),""==(null===(s=c.v)||void 0===s?void 0:s.data)&&(0,y.jsx)(U,{block:!0,r:"0.5rem"}),b(h,(e=>(0,y.jsxs)("div",{className:Se.error,children:[(0,y.jsx)("div",{children:e}),(0,y.jsx)("button",{onClick:()=>h.reset(),children:"\u041e\u041a"})]}))),(0,y.jsx)(xe,{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440: "+o.v,itemId:n.id,mutationFn:we,open:i.v,close:i.setF}),(0,y.jsx)(xe,{title:"\u0423\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u043a\u043e\u043b-\u0432\u043e \u043d\u0430 1: "+o.v,itemId:n.id,mutationFn:Ne,open:r.v,close:r.setF}),(0,y.jsx)("div",{className:Se.id,children:n.id}),(0,y.jsxs)("label",{className:Se.img,children:[(n.img||c.v)&&(0,y.jsx)("img",{src:(null===(t=c.v)||void 0===t?void 0:t.data)||n.img,alt:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430"}),(0,y.jsx)("input",{type:"file",style:{display:"none"},accept:"image/png, image/jpeg, image/gif",onChange:async e=>{var s,t;c.set({data:"",name:""}),c.set(await Ee(null===(s=e.target)||void 0===s||null===(t=s.files)||void 0===t?void 0:t[0],"")),e.target.value=""}})]}),(0,y.jsxs)("div",{className:Se.inputs,children:[(0,y.jsx)("div",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}),(0,y.jsx)("input",{type:"text",value:o.v,onChange:e=>o.set(e.target.value)}),(0,y.jsx)("div",{children:"\u0426\u0435\u043d\u0430"}),(0,y.jsx)("input",{type:"number",value:m.v,onChange:e=>m.set(e.target.valueAsNumber)}),(0,y.jsx)("div",{children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"}),(0,y.jsx)("input",{type:"number",value:d.v,onChange:e=>d.set(e.target.valueAsNumber)})]}),(0,y.jsxs)("div",{className:Se.buttons,children:[!l.v&&(0,y.jsx)("button",{onClick:i.setT,children:(0,y.jsx)(je,{})}),!l.v&&(0,y.jsx)("button",{className:Se.btnMinus,onClick:r.setT,children:"-1"}),l.v&&(0,y.jsx)("button",{onClick:()=>{h.mutate({name:o.v,count:d.v,price:m.v,img:c.v||void 0})},children:(0,y.jsx)(ge,{})}),l.v&&(0,y.jsx)("button",{onClick:()=>v(),children:(0,y.jsx)(ye,{})})]})]})}const Re={items:"styles_items__34Dlt"};function Fe(){var e;X("\u0422\u043e\u0432\u0430\u0440\u044b");const s=fe();return(0,y.jsxs)(L,{centeredPage:!0,gap:"0.5rem",homeBtn:!0,children:[s.isLoading&&(0,y.jsx)(U,{}),b(s),(0,y.jsx)("h1",{children:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430\u043c\u0438"}),(0,y.jsx)(Ce,{}),(0,y.jsx)("div",{className:Re.items,children:null===(e=s.data)||void 0===e?void 0:e.map((e=>(0,y.jsx)(Ie,{item:e},e.id)))})]})}const qe={root:"styles_root__3AhF7",title:"styles_title__AMBJ6",map:"styles_map__lp2hs",btns:"styles_btns__P557j",active:"styles_active__OfSUZ",background:"styles_background__23nEs"},Qe=t.p+"static/media/map1.f12554b9054ea5e2c850.png",Ue=t.p+"static/media/map2.231e4c0be2d1c6ff5950.png",Me=t.p+"static/media/map3.8a733cb476e5d20c9a65.png",Be={root:"styles_root__cV7H9",active:"styles_active__RcNKa"};function Te(e){let{curPage:s=""}=e;return(0,y.jsx)("div",{className:Be.root,children:(0,y.jsxs)("div",{children:[(0,y.jsx)(I.rU,{className:"map"==s?Be.active:"",to:"/map",children:"\u041a\u0430\u0440\u0442\u0430"}),(0,y.jsx)(I.rU,{className:"timetable"==s?Be.active:"",to:"/timetable",children:"\u041f\u043b\u0430\u043d"}),(0,y.jsx)(I.rU,{className:"quest"==s?Be.active:"",to:"/quest",children:"\u041a\u0432\u0435\u0441\u0442"}),(0,y.jsx)(I.rU,{className:"store"==s?Be.active:"",to:"/store",children:"\u041c\u0430\u0433\u0430\u0437"}),(0,y.jsx)(I.rU,{className:"race"==s?Be.active:"",to:"/race",children:"\u0413\u043e\u043d\u043a\u0438"})]})})}function Le(){X("\u041a\u0430\u0440\u0442\u0430");const e=me(0);return(0,y.jsxs)(L,{centeredPage:!0,headerColor:"#042e40",gap:"1em",className:qe.root,footer:(0,y.jsx)(Te,{curPage:"map"}),children:[(0,y.jsx)("div",{className:qe.background}),(0,y.jsx)("h1",{className:qe.title,children:"Underparty"}),(0,y.jsx)("div",{className:qe.map,children:(0,y.jsx)("img",{src:[Qe,Ue,Me][e.v],alt:"\u041a\u0430\u0440\u0442\u0430"})}),(0,y.jsxs)("div",{className:qe.btns,children:[(0,y.jsx)("button",{onClick:()=>e.set(0),className:0==e.v?qe.active:"",children:"\u042d\u0442\u0430\u0436 1"}),(0,y.jsx)("button",{onClick:()=>e.set(1),className:1==e.v?qe.active:"",children:"\u042d\u0442\u0430\u0436 2"}),(0,y.jsx)("button",{onClick:()=>e.set(2),className:2==e.v?qe.active:"",children:"\u041c\u0430\u0440\u043a\u0435\u0442"})]})]})}var De=t(741);function Pe(e){let{code:s,scale:t=10,margin:n=1,color:a="#000000",colorBg:l="#ffffff"}=e;const[i,r]=(0,j.useState)("");return(0,j.useEffect)((()=>{s&&(r(""),De.toDataURL(s,{errorCorrectionLevel:"H",scale:t,margin:n,color:{dark:a,light:l}},((e,s)=>r(s))))}),[s,a,t,n,l]),(0,y.jsx)("img",{src:i,alt:s,style:{width:"100%"}})}const Je={root:"styles_root__sSzNc",qr:"styles_qr__cpZSD"};function Xe(e){var s;let{role:t}=e;X("\u041f\u043e\u0432\u044b\u0448\u0435\u043d\u0438\u0435");const n=m(),a={worker:"\u0432\u043e\u043b\u043e\u043d\u0442\u0451\u0440\u0430",manager:"\u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0435\u0433\u043e"}[t],l={worker:"\u0432\u043e\u043b\u043e\u043d\u0442\u0451\u0440\u043e\u043c",manager:"\u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u043c"}[t];return a?(0,y.jsxs)(L,{centered:!0,gap:"1rem",height100:!0,className:Je.root,homeBtn:!0,children:[(0,y.jsxs)("h1",{children:["\u041f\u043e\u0432\u044b\u0448\u0435\u043d\u0438\u0435 \u0434\u043e ",a]}),(0,y.jsx)("div",{className:Je.qr,children:(0,y.jsx)(Pe,{code:"promote_".concat(t,"_").concat(null===(s=n.data)||void 0===s?void 0:s.id),colorBg:"#ffffff00",scale:13})}),(0,y.jsxs)("h3",{children:["\u041f\u043e\u0441\u043b\u0435 \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c\u0441\u044f ",l]})]}):(0,y.jsx)(L,{children:"\u041e\u0448\u0438\u0431\u043a\u0430!"})}const Ve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA4QAAACBCAMAAACvtYQnAAAAAXNSR0IB2cksfwAAAAlwSFlzAABcRgAAXEYBFJRDQQAAAJZQTFRFAAAAAAAA////RjFPiEc7/+e9oKmd/8kOoEoAU1NQfFs1HRQhQCxIKBwuNSU84tSzjpWLWFlVs7WjEg0UHxANv72nDgcHwHUEb3JsZTQrqK6fY2RgzMasBwQFmqKX9+K62c6wLiA0PB8a7Nu3zYcHsWACJhQUSychNBwZoUwEXzEpAAAAeX12blEv3p0Jej81g4mAAAAA6QvGggAAADJ0Uk5TAP///////////////////////////////////////////////////////8P//////yzgQytLAAAG90lEQVR4nO3d21rbOBRA4WxICDQhJJzP0CmlnWmn7bz/y00syyfJhnwQJG17/RctDb0QqVdjHQijET6YyHg8Fok9jK0S+fTpU5pfk8j+/n6aQ0M0RBiUyNPTU5pDQzREGJTIdDpNc2iIhgiDIkL4+hdhlqCk+hURIVwmwXG/MiRCqNLfCGOPogMRwtXDCIUIoUoWoeS/xB7KthAhdOldhAkvjBpECBcRBkaEcBFhYEQIFxEGRoTw9WyzngihT58ilKT36Q2+iwI+IgyKCOGzET7HHsf7pX4nahAhXIpPzHgjJkKoRISBESFcaiMUmUwas7//fiiJkNVRNKndJ/Qi/CFECJVURzjJOqweSH1h1OB2FC4iDIwI4epbhDGHtBEihEtrhJJFeL33WE4M0/4uwgpzQvh0npghQvSIxgjtvej1Xm4doPyrIkFuR9GGCIMiQviIMCgihEvniRkToS3wICcKticyzAnhIsLAiBCuPkS4tCWq+BKIEC6V+4TSFaGk/3pIhHBpj/D+frVaR7haESG0UhihXRo1EV4eHNgXxFX2kT3JlnKJRAgXEQZGhHBpjfA4T8+J0HAOdieGCOFTt1lPhOgbxREul+sIl8v77KObmxuT4PExEUIbxRGu8n16s0Vxr+J1kAjRhgiDIkK41J2YsWuj9QgP3Olgyl8KEcJFhIERIVx9iPDm8tIkeHaW+r3oKBv/r1+/0h4iAlO3T9gS4VLJdNDg+wnhIsLAiBAuxRE2p4MP6U8HDSKEiwgDI0K4VEb45fb2Oo/w8udPk+Dt7YOGe9EREaKNrs16862ER+X7WvzRNB00iBA+ZRFmtRURrm5MhNfX15oi/Pr1q4qRIhxNEdoJYRGhPap2pCdBNuvRhgiDIkK4dJ2YqSL8eXn5J58QPj7mazKxx7YhkYuLCxVPNkLRGuGNpvOidSzMwKU8wmMV50XreCWES9c+oRfho7IEmRPCR4SBESFcWiNcLpd7e0dfVK3JGOwTwqU1QlXnRetYmIFLU4RFgo9ne3tnt2vq7kVH2Rfx9PSkbMz4aHo2622EZ9mL4JfJRGOCzAnRhgiDIkL4FEZ49vCgNEEiRBuNEZYvgxqG3USEcGk6MVMuzBwVEcYe0RsQIVwKI5xM1N6LjogQPiIMjAiRqyZTCvcJNSfIZj0KRBgNESIjcnX1bK8DPRE2b0ZTH20nIkQma+57V4TJXh/1CNXsTZiBimU/IkL0I8LYo9mQtCBCFCuiV/blpL5Zn/KNaRVhogP0iezs7JhfDPtHVkdBhMEQIbrYvcHfv6v06o8neoWUEaY5vDZVf02JPsMIqLZBXxkpiVDNmsyoM0KRH7FHhtiURxh7IJvrjFDR14CPYVdHRRa7FUn9AJuJMNGxdei6HeV+FEQYCBGiS9bfYRbeSfbRvIww7dvR+mE7JexyqOxUvxmsj+LVCBO9QJIdWJcXI5Tm34w1RsShNUJ1iBAd1v/+WXULkausufM8SONc8k9yTWxB54ww83d2dq3aoGWaOCgiRBgGEaKDyCzLbSan48JfeZUNXBPvZiPMUjtpyXB/f79YJyXC4bDb8ptGWP1PjbfYMEKDCIeCCIMiQjiqtc8NIyyXSrk83iZPS1pWR4sl0vofeZYHgAhDI0I0FGfSarm1rY46HRaVcoG8Re12VLwEi9tRIhwOIgyPCNFAhOERIRxi38ainln92NquPbnmRcic8I1e3KxnTjhERBgaEcLnRNZ0UjbXiJBr482IED4iDIoI0Wp99zmftyQ4n8/Oz02E5+fF3yDC93kxwun04uKCCAepPLbmEPlnXK2FSjVFjD1gxV6LkNXRgSLCcIgQbewS6d2GEcYerm6vfT9h8wGe7aEgwoCIEL7yCMzzYuGszpycfLu6IsKtMj9/qbXA9eNEOFDVObQ7/6jaSf19uYlwC16M0PsUz/YwEGFQRAhXlWBrhMVyaLWjz2XxXubHoLVE2PYoz/YQEGFwRAiX6cvcb7YdmtndnZV2dw8PD7ks3stE6N14TqdEOFyvRei8KsYern5mk8L8iHrbmdFIsNzH4PkejHWEv8d3d1WE89azpPM5EW4BEaKFe2wti61lfsiJta0oCisjtI9Ks0oiHBbv7CgRfqANIqy9C0bkwSKgdYVFhoez2be177NGl7PZjHeW2Yr2CEfN8IhwkMqFGbtB77zvaPWWo7EHql3xo9Hs794nvI8xGCLm7Ohi8XyavwPw6Wl1mHSxOLWPcmG8FxGim5kH1nfvRT6Xr4O80eH2SDUPbP9E6ycxBEQYCBGiW7Fx34xwVn+USwP4SF6EUm5NECEQiBPh5zUiBIIqi7P7VfXNZOYpQABECESXRUhuQERECESWRxh7FMCgkSAQGRECAAC85H9dUmyofnI0YwAAAABJRU5ErkJggg==",Oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAAuCAYAAAD0kU3xAAAACXBIWXMAAAsTAAALEwEAmpwYAAABtElEQVR4nO2cUY7DIAxEN6veJceMesyeJv2iclEIxLHBTOd9tRIEyGADNu2yb+v+R6bnf3QHiA0UEoSH/LI8X6P6QRTs2/r5TIsEgUKCQCFBoJAgUEgQKCQIj3qRfsjtdM7Z0eisntUzjuq2tnv0jFTX6sjXxSL3ba0O+upL0fZD23ZeRtPfVEfWtRq3u0XWZp4cyFmZUrlafc0ESs85Ei9q0GToGnl3NnrUl0JZuNNeuFqk9TrgzVE/l+erKngiL9dz3G4WGXXmouK+RlrMylkseiQuFklr7I/rZoeW1A9zIWmNY3CzSFpjXxhrBcFUyNnOjUjQIkGgkCBUAwItQW1Zbma3OmrHrU3fSaoWWco0kFg0hehk4DhyKucuLam2Hu1q2mteI9HdaiRyL9girGqzQxcbj0tCcr2My+U0VinR6sXIZO1MqPKRSczWo0kvftlLTBsQ0IqGKrb6hoB0sVpr1LppjbvNryBG8CAlNJ5u+AVlefWwJGrkl26BhZe45VotX/AIsTRtWt1Bsh7vIv8MAn3mo8FfLANCIUGgkCBQSBAoJAhf50jUqMcvQIsEgUKC8AZ00sAcaiLsEQAAAABJRU5ErkJggg==",Ze={root:"styles_root__CEdGL",background:"styles_background__dxeLP",body:"styles_body__o-6ZK",window:"styles_window__ASnVo",title:"styles_title__6wHPv",btn:"styles_btn__lL+tu",items:"styles_items__yJ9sj",quests:"styles_quests__58NxQ",quest:"styles_quest__65tbN",quest_completed:"styles_quest_completed__6XOvB",questDescription:"styles_questDescription__bMEbk",questDescription__body:"styles_questDescription__body__-HZ3d"},Ge={root:"styles_root__sa0ap",header:"styles_header__thHuO",body:"styles_body__27+PL",body_scroll:"styles_body_scroll__SwZun",body_arrows:"styles_body_arrows__y8hcc"},ze="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAAaAQMAAADMuZOBAAAAAXNSR0IB2cksfwAAAAlwSFlzAABcRgAAXEYBFJRDQQAAAAZQTFRFAAAAAAAApWe5zwAAAAJ0Uk5TAP9bkSK1AAAAVklEQVR4nGNgIB/w///nwAhnPmCGMwvYoKz//yx4wEwgWSdjAWfyFcCZ7A/gTOYDID1/0JjsCXAmH8IEGRk404IPxkwoYIczDzA3QN3wsIERxnxAog8BPG0j3jpV/PcAAAAASUVORK5CYII=";function He(e){let{children:s,title:t="Underparty",footer:n,className:a,disableScroll:l=!1,onClose:i}=e;const r=(0,j.useRef)(null),c=de(!0);return(0,j.useEffect)((()=>{r.current&&c.set(r.current.scrollHeight>r.current.clientHeight)}),[s,r.current]),(0,y.jsxs)("div",{className:f(Ge.root,a),children:[(0,y.jsxs)("div",{className:Ge.header,children:[(0,y.jsx)("div",{children:t}),(0,y.jsx)("button",{onClick:i,children:(0,y.jsx)("img",{src:ze,alt:"close"})})]}),(0,y.jsx)("div",{className:f(Ge.body,!l&&Ge.body_scroll,c.v&&!l&&Ge.body_arrows),children:(0,y.jsx)("div",{ref:r,children:s})}),(0,y.jsx)("div",{children:n})]})}function We(){X("\u041a\u0432\u0435\u0441\u0442\u044b");const e=me(null),s=(0,a.useQuery)("quests",(async()=>await d("/api/quests")));return(0,y.jsxs)(L,{centeredPage:!0,headerColor:"#545f82",gap:"1em",className:Ze.root,footer:(0,y.jsx)(Te,{curPage:"quest"}),children:[(0,y.jsx)("div",{className:Ze.background}),(0,y.jsx)("h1",{className:Ze.title,children:"Underparty"}),s.isLoading&&(0,y.jsx)(U,{}),(0,y.jsxs)("div",{className:Ze.body,children:[(0,y.jsx)(He,{className:Ze.window,title:"\u041a\u0432\u0435\u0441\u0442\u044b",footer:(0,y.jsx)("img",{className:Ze.items,src:Ve,alt:""}),onClose:()=>e.set(null),children:e.v?(0,y.jsxs)("div",{className:Ze.questDescription,children:[(0,y.jsxs)("button",{className:f(Ze.quest,e.v.completed&&Ze.quest_completed),onClick:()=>e.set(null),children:[(0,y.jsx)("span",{children:e.v.name}),(0,y.jsx)("span",{children:Ke(e.v.reward)})]},e.v.id),(0,y.jsx)("div",{className:Ze.questDescription__body,children:e.v.description||"\u041d\u0435\u0442 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f"}),(0,y.jsx)(I.rU,{to:"/scanner",className:Ze.btn,children:(0,y.jsx)("img",{src:Oe,alt:"\u0421\u0434\u0430\u0442\u044c"})})]}):(0,y.jsxs)("div",{className:Ze.quests,children:[b(s),s.data&&Ye.concat(s.data).map((s=>(0,y.jsxs)("button",{className:f(Ze.quest,s.completed&&Ze.quest_completed),onClick:()=>e.set(s),children:[(0,y.jsx)("span",{children:s.name}),(0,y.jsx)("span",{children:Ke(s.reward)})]},s.id)))]})}),(0,y.jsx)(I.rU,{to:"/scanner",className:Ze.btn,children:(0,y.jsx)("img",{src:Oe,alt:"\u041a\u0443\u043f\u0438\u0442\u044c"})})]})]})}const Ye=[{id:-1,name:"\u0411\u0430\u0440\u0430\u0445\u043e\u043b\u043a\u0430",description:"\u0421\u0434\u0430\u0439\u0442\u0435 \u043e\u0434\u043d\u043e [\u0411\u0410\u0420\u0410\u0425\u041b\u041e], \u0447\u0442\u043e\u0431\u044b \u043e\u0431\u043c\u0435\u043d\u044f\u0442\u044c \u0435\u0433\u043e \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u0435 [\u0411\u0410\u0420\u0410\u0425\u041b\u041e] \u0438\u043b\u0438 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u0432\u0430\u043b\u044e\u0442\u0443 GGG!",reward:1/0,completed:!1}];function Ke(e){return isFinite(e)?e+"G":"\u221e"}function $e(e,s){const t=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>{const s=await u("/api/scanner",e);return t.setQueryData("user",(e=>((e=e||{auth:!1,id:"",balance:0,roles:[],name:"",last_name:"",photo:"",operations:[]}).balance=s.balance,"ok"==s.res&&"promote"==s.action&&t.invalidateQueries("user"),e))),s},onSuccess:e,onError:s})}const es={root:"styles_root__QdJnV",msg:"styles_msg__plnAU",msg_visible:"styles_msg_visible__G0rDm",msg_dimmed:"styles_msg_dimmed__0Xs60",bar:"styles_bar__VuYbs",bar_full:"styles_bar_full__poY0b"},ss={error:"styles_error__EtK3I",video:"styles_video__b88Zl"},ts=t.p+"static/media/beep.38f199e084efe5461ffd.mp3";function ns(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[t]=(0,j.useState)((()=>{const t=new Audio(e);return t.preload="auto",s&&t.addEventListener("ended",t.play),t}));return()=>{t.currentTime=0,t.play()}}var as=t(1096);let ls=e=>{},is=()=>{},rs=!1,cs=null,os=null;function ds(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;if(!os){cs=document.createElement("div"),document.body.appendChild(cs),cs.style.display="flex",cs.style.backgroundColor="black";const e=document.createElement("video");cs.appendChild(e),os=new as.Z(e,(e=>ls(e.data)),{highlightScanRegion:!0,maxScansPerSecond:10})}(0,j.useEffect)((()=>(setTimeout((()=>{var e;return null===(e=os)||void 0===e?void 0:e.start().catch((()=>{setTimeout((()=>{var e;null===(e=os)||void 0===e||e.start().catch((()=>is()))}),250)}))}),100),()=>{var e;null===(e=os)||void 0===e||e.stop()})),[]);const[t,n]=(0,j.useState)(!1),[a,l]=(0,j.useState)(""),[i,r]=(0,j.useState)(rs),c=ns(ts);return ls=a=>{t||e||(l(a),n(!0),c(),setTimeout((()=>{l(""),n(!1)}),s))},is=()=>{rs=!0,r(!0)},i?{scanned:a,scanner:(0,y.jsxs)("div",{className:ss.error,children:[(0,y.jsx)("h1",{children:"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043a\u0430\u043c\u0435\u0440\u0435"}),(0,y.jsx)("p",{children:"\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u043c\u0435\u0440\u044b \u044d\u0442\u043e\u043c\u0443 \u0441\u0430\u0439\u0442\u0443 \u0438 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0443, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0442\u0435."}),(0,y.jsx)("p",{children:"\u041f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443."})]})}:{scanned:a,scanner:(0,y.jsx)("div",{children:(0,y.jsx)("div",{ref:e=>{e&&(e.innerHTML="",e.appendChild(cs))},className:ss.video})})}}function us(e){let{useMutation:s,onScan:t,formatMsg:n,onRes:a,className:l,pause:i}=e;const[r,c]=(0,j.useState)(""),[o,d]=(0,j.useState)(""),u=(0,j.useRef)(null),m=s((e=>{c(n(e)),d(""),x(),null===a||void 0===a||a(e)}),(e=>{c(""),d(p(e)),x()})),{scanned:h,scanner:v}=ds(!m.isIdle||i);function x(){var e;setTimeout((()=>m.reset()),1e3),null===(e=u.current)||void 0===e||e.classList.add(es.bar_full),setTimeout((()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.classList.remove(es.bar_full)}),100)}return(0,j.useEffect)((()=>{if(""==h||!m.isIdle)return;c(""),d("");const e=t(h);e?m.mutate(e):d("\u041d\u0435 \u043e\u043f\u043e\u0437\u043d\u0430\u043d\u043e")}),[h]),(0,y.jsxs)("div",{className:f(es.root,l),children:[m.isLoading&&(0,y.jsx)(U,{}),v,(0,y.jsxs)("div",{className:f(es.msg,(r||o)&&es.msg_visible,(r||o)&&m.isIdle&&es.msg_dimmed),children:[(0,y.jsx)("h2",{children:r}),(0,y.jsx)("h2",{children:o})]}),(0,y.jsx)("div",{ref:u,className:es.bar})]})}const ms={root:"styles_root__CrawG",background:"styles_background__sRVhE","anim-background":"styles_anim-background__FEgkK",body:"styles_body__WfmVk",gold:"styles_gold__NCkdw"};function hs(){var e,s,t,n;X("\u0421\u043a\u0430\u043d\u0435\u0440");const a=de(!1),l=me(null,a.setT);return(0,y.jsxs)(L,{centeredPage:!0,headerColor:"#51185b",gap:"1em",className:ms.root,footer:(0,y.jsx)(Te,{}),homeBtn:!0,children:[(0,y.jsx)("div",{className:ms.background}),(0,y.jsx)(He,{title:"QR-\u0410\u043a\u0442\u0438\u0432\u0430\u0442\u043e\u0440",disableScroll:!0,className:ms.body,children:(0,y.jsx)(us,{useMutation:$e,pause:a.v,onScan:e=>{const s=["quest_","item_","send_","promote_"];for(const t of s)if(e.startsWith(t))return{code:e};return null},formatMsg:e=>{var s;return null!==(s={ok:"",wrong:"\u041d\u0435\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 QR",error:e.msg}[e.res])&&void 0!==s?s:e.res},onRes:e=>{"ok"==e.res&&l.set(e)}})}),(0,y.jsxs)(W,{title:"\u0410\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u043e",open:a.v,close:a.setF,children:["quest"==(null===(e=l.v)||void 0===e?void 0:e.action)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("h1",{children:"\u041a\u0432\u0435\u0441\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d!"}),(0,y.jsx)("br",{}),(0,y.jsx)("h2",{children:l.v.msg}),(0,y.jsx)("br",{}),(0,y.jsxs)("h2",{children:[(0,y.jsx)("span",{children:"\u041d\u0430\u0433\u0440\u0430\u0434\u0430: "}),(0,y.jsxs)("span",{className:ms.gold,children:[l.v.value,"G"]})]})]}),"store"==(null===(s=l.v)||void 0===s?void 0:s.action)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("h1",{children:"\u041a\u0443\u043f\u043b\u0435\u043d\u043e!"}),(0,y.jsx)("br",{}),(0,y.jsx)("h2",{children:l.v.msg}),(0,y.jsx)("br",{}),(0,y.jsxs)("h2",{children:[(0,y.jsx)("span",{children:"\u041f\u043e\u0442\u0440\u0430\u0447\u0435\u043d\u043e: "}),(0,y.jsxs)("span",{className:ms.gold,children:[l.v.value,"G"]})]})]}),"send"==(null===(t=l.v)||void 0===t?void 0:t.action)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("h1",{children:l.v.value>0?"\u041f\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u043e":"\u0412\u044b\u0447\u0442\u0435\u043d\u043e"}),(0,y.jsx)("br",{}),(0,y.jsxs)("h1",{className:ms.gold,children:[l.v.value>0?"+":"",l.v.value,"G"]})]}),"promote"==(null===(n=l.v)||void 0===n?void 0:n.action)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("h1",{children:"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"}),(0,y.jsx)("br",{}),(0,y.jsxs)("h2",{children:["\u0422\u0435\u043f\u0435\u0440\u044c \u0432\u044b ",{worker:"\u0432\u043e\u043b\u043e\u043d\u0442\u0451\u0440",manager:"\u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0439"}[l.v.msg]||"\u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e"]})]})]})]})}const vs={block:"styles_block__jLSvl",value:"styles_value__AMUT8",action:"styles_action__S+Amy",reusable:"styles_reusable__AlAhN",checkbox:"styles_checkbox__5B3El",qr:"styles_qr__NIQPC",send:"styles_send__R5BDM",check:"styles_check__tkMiQ",notUsed:"styles_notUsed__BJDX-",used:"styles_used__GIw2A"};function xs(){var e,s,t,n,l,i,r,c;X("\u041a\u0430\u0437\u043d\u0430\u0447\u0435\u0439\u0441\u0442\u0432\u043e");const o=de(!1),d=me(null,o.setT),m=(h=d.set,(0,a.useMutation)({mutationFn:async e=>await u("/api/send",e),onSuccess:h}));var h;const v=function(e){return(0,a.useMutation)({mutationFn:async e=>await u("/api/send_check",{id:e}),onSuccess:e})}(),x=de(!1),_=me(1);function j(e){m.mutate({value:_.v,positive:e,reusable:x.v}),v.reset()}return(0,y.jsxs)(L,{centered:!0,homeBtn:!0,children:[(0,y.jsx)("h2",{children:"\u041a\u0430\u0437\u043d\u0430\u0447\u0435\u0439\u0441\u0442\u0432\u043e"}),m.isLoading&&(0,y.jsx)(U,{}),v.isLoading&&(0,y.jsx)(U,{}),b(m),(0,y.jsxs)("div",{className:vs.block,children:[(0,y.jsx)("input",{className:vs.value,type:"number",name:"value",value:_.v,onChange:e=>_.set(Math.max(1,e.target.valueAsNumber))}),(0,y.jsxs)("label",{className:vs.reusable,children:[(0,y.jsx)("span",{children:"\u041c\u043d\u043e\u0433\u043e\u0440\u0430\u0437\u043e\u0432\u044b\u0439"}),(0,y.jsxs)("div",{className:vs.checkbox,children:[(0,y.jsx)("input",{type:"checkbox",checked:x.v,onChange:e=>x.set(e.target.checked)}),(0,y.jsx)("span",{})]})]}),(0,y.jsxs)("div",{className:vs.action,children:[(0,y.jsx)("button",{onClick:()=>j(!0),children:"\u041d\u0430\u0447\u0438\u0441\u043b\u0438\u0442\u044c"}),(0,y.jsx)("button",{onClick:()=>j(!1),children:"\u0421\u043f\u0438\u0441\u0430\u0442\u044c"})]})]}),(0,y.jsxs)(W,{title:null!==(e=d.v)&&void 0!==e&&e.reusable?"\u041c\u043d\u043e\u0433\u043e\u0440\u0430\u0437\u043e\u0432\u044b\u0439":"\u041e\u0434\u043d\u043e\u0440\u0430\u0437\u043e\u0432\u044b\u0439",open:o.v,close:o.setF,children:[(0,y.jsx)("div",{className:vs.qr,children:(0,y.jsx)(Pe,{code:"send_"+(null===(s=d.v)||void 0===s?void 0:s.id),colorBg:"#ffffff00",scale:13})}),(0,y.jsxs)("div",{className:vs.send,children:[(0,y.jsx)("h2",{children:null!==(t=d.v)&&void 0!==t&&t.positive?"\u0417\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435":"\u0421\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),(0,y.jsxs)("h1",{children:[null!==(n=d.v)&&void 0!==n&&n.positive?"+":"-",null===(l=d.v)||void 0===l?void 0:l.value," G"]})]}),b(v),!(null!==(i=d.v)&&void 0!==i&&i.reusable)&&(0,y.jsxs)("div",{className:vs.check,children:[(0,y.jsx)("button",{onClick:()=>{var e;return v.mutate((null===(e=d.v)||void 0===e?void 0:e.id)||"")},children:"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c"}),(0,y.jsx)("span",{className:null!==(r=v.data)&&void 0!==r&&r.successful?vs.used:vs.notUsed,children:null!==(c=v.data)&&void 0!==c&&c.successful?"\u0423\u0441\u043f\u0435\u0448\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0432\u043e\u0434":"\u041d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d"})]})]})]})}const _s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAAuCAYAAAD0kU3xAAAACXBIWXMAAAsTAAALEwEAmpwYAAACD0lEQVR4nO2ca3KDMAyEoZO7cEwmx8xpyI+OW8exZEkIg8V+M5k8wJh4vVgSbeZtXbYJDM/P2ScAfICQQXjkb+bn66zzAAa2dfl7DUcGAUIGAUIGAUIGAUIGAUIG4dHexYc8VKbSHGofrq10GwfVrnaeknPU9sn1J8XsyG1dqg9qX8vxtW3zNr3baam1tRwnYXIkNYPSQKCw0B+1kLmI5QxKn0HM/qiELEWsOfKqYu5ZzzTHpvo4eizUa2Q6IWqxtghYrk3z83WpSTACpmDHa4EGfuzOI+/iHG1E2xsUBIJgilrLtTA959ukx8q5i7uPQOXIUrD0upaSQJS+mEt0Scwjw/orMMp3Mqcf0/Rdpqvt482ZA3vlq4zJkfllldrGsVf0UVzSk113PzxmaC8nR6cpJDf7rQOvWVc59x/N1frkxpsVsnVf7i4R6gjfr+lIyhG9nRI9Ok5Yb46TUWtZT02pRnp41VtrUbCkzQgu8UA6Pqr0o5b8n7mGgX/MlZ3a59EYyfkiIanSnKauaqX190DgF1JIyn1lac5jxtZKfS3hIOwnooJAKV6ZdvQaVGnOeUfYSyvlEk5Ub+4szjR9V76o8RDlka1U4+6D7Yn16iYOdiixJCJahM7bSKLHcn+uf+o9dwxJPxa8IuM5/zEIOGss8B/LAYGQQYCQQYCQQYCQQfjII1H2Ghc4MggQMghv++Fo+AHadn0AAAAASUVORK5CYII=",js={root:"styles_root__0CejE",background:"styles_background__PMiwv",body:"styles_body__c+IRT",title:"styles_title__u3Xt9",btn:"styles_btn__LjRSK",items:"styles_items__n-Fvc",item:"styles_item__zIxt2",item__img:"styles_item__img__r3iEr",item__desc:"styles_item__desc__wbcAM",item_few:"styles_item_few__nkL6C",item_ended:"styles_item_ended__Mn60C"};function gs(){var e;X("\u041c\u0430\u0433\u0430\u0437\u0438\u043d");const s=(0,a.useQuery)("storeItems",(async()=>await d("/api/store_items")));return(0,y.jsxs)(L,{centeredPage:!0,headerColor:"#0a424c",gap:"1em",className:js.root,footer:(0,y.jsx)(Te,{curPage:"store"}),children:[s.isLoading&&(0,y.jsx)(U,{}),(0,y.jsx)("div",{className:js.background}),(0,y.jsx)("h1",{className:js.title,children:"Underparty"}),(0,y.jsxs)("div",{className:js.body,children:[(0,y.jsx)(He,{title:"\u041c\u0430\u0433\u0430\u0437\u0438\u043d",className:js.list,children:(0,y.jsxs)("div",{className:js.items,children:[b(s),null===s||void 0===s||null===(e=s.data)||void 0===e?void 0:e.map((e=>(0,y.jsxs)("div",{className:f(js.item,"few"==e.count&&js.item_few,"no"==e.count&&js.item_ended),children:[(0,y.jsx)("div",{className:js.item__img,children:e.img?(0,y.jsx)("img",{src:e.img,alt:"\u0422\u043e\u0432\u0430\u0440"}):(0,y.jsx)("div",{})}),(0,y.jsxs)("div",{className:js.item__desc,children:[(0,y.jsx)("span",{children:e.name}),(0,y.jsxs)("span",{children:[e.price," G"]})]})]},e.id)))]})}),(0,y.jsx)(I.rU,{to:"/scanner",className:js.btn,children:(0,y.jsx)("img",{src:_s,alt:"\u041a\u0443\u043f\u0438\u0442\u044c"})})]})]})}const ys={root:"styles_root__E5y+5",title:"styles_title__3QqY9",body:"styles_body__nvDgq",list:"styles_list__6yPeV",items:"styles_items__UxmDm",btns:"styles_btns__Ctsik",active:"styles_active__1eH-B",background:"styles_background__f5ayg"};function ps(){X("\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435");const e=de(!0),s=de(!0),t=de(!0);return(0,y.jsxs)(L,{centeredPage:!0,headerColor:"#4d0709",className:ys.root,footer:(0,y.jsx)(Te,{curPage:"timetable"}),children:[(0,y.jsx)("div",{className:ys.background}),(0,y.jsx)("h1",{className:ys.title,children:"Underparty"}),(0,y.jsxs)("div",{className:ys.body,children:[e.v?(0,y.jsx)(He,{className:ys.list,title:"\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 | "+(s.v?"\u0413\u043b\u0430\u0432\u043d\u0430\u044f":"\u0412\u0442\u043e\u0440\u0430\u044f")+" \u0441\u0446\u0435\u043d\u0430",footer:(0,y.jsxs)("div",{className:ys.btns,children:[(0,y.jsx)("button",{onClick:s.setT,className:s.v?ys.active:"",children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"}),(0,y.jsx)("button",{onClick:s.setF,className:s.v?"":ys.active,children:"\u0412\u0442\u043e\u0440\u0430\u044f"})]}),children:(0,y.jsx)("div",{className:ys.items,children:(s.v?bs:As).map(((e,s)=>(0,y.jsx)("div",{children:e},s)))})}):(0,y.jsx)(He,{className:ys.list,title:"\u0422\u0443\u0440\u043d\u0438\u0440\u044b | "+(t.v?"Under":"\u0420\u0435\u0442\u0440\u043e"),footer:(0,y.jsxs)("div",{className:ys.btns,children:[(0,y.jsx)("button",{onClick:t.setT,className:t.v?ys.active:"",children:"Under"}),(0,y.jsx)("button",{onClick:t.setF,className:t.v?"":ys.active,children:"\u0420\u0435\u0442\u0440\u043e"})]}),children:(0,y.jsx)("div",{className:ys.items,children:(t.v?fs:Ns).map(((e,s)=>(0,y.jsx)("div",{children:e},s)))})}),(0,y.jsxs)("div",{className:ys.btns,children:[(0,y.jsx)("button",{onClick:e.setT,className:e.v?ys.active:"",children:"\u041f\u043b\u0430\u043d"}),(0,y.jsx)("button",{onClick:e.setF,className:e.v?"":ys.active,children:"\u0422\u0443\u0440\u043d\u0438\u0440"})]})]})]})}const bs=["12:50 - \u0426\u0435\u0440\u0435\u043c\u043e\u043d\u0438\u044f \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f","13:00 - Shima Nori Piano Performance","13:45 - \u041a\u043e\u0441\u043f\u043b\u0435\u0439 \u0434\u0435\u0444\u0438\u043b\u0435","14:45 - \u0421\u043b\u0443\u0427\u0430\u0439\u043d\u043e\u0441\u0442\u044c","15:30 - \u0410\u0443\u043a\u0446\u0438\u043e\u043d","16:00 - UnderEvent \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b Game Jam","16:30 - \u0413\u043e\u043d\u043a\u0438 \u0443\u043b\u0438\u0442\u043e\u043a","17:00 - \u041c\u0443\u0437\u044b\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0432\u044b\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u044f","17:30 - \u0424\u0438\u043d\u0430\u043b \u0442\u0443\u0440\u043d\u0438\u0440\u043e\u0432: Undercards & UV Battles","18:30 - \u041d\u0430\u0433\u0440\u0430\u0436\u0434\u0435\u043d\u0438\u0435","19:00 - Undertale \u0410\u043d\u0438\u043c\u0430\u0446\u0438\u0438","19:55 - \u0417\u0430\u043a\u0440\u044b\u0442\u0438\u0435 \u0441\u0446\u0435\u043d\u044b"],As=["12:00 - \u041e\u0442\u0432\u0435\u0442\u044b \u043d\u0430 \u0432\u043e\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u042e\u0442\u0443\u0431\u0435\u0440\u043e\u0432","12:40 - \u041b\u043e\u0442\u0435\u0440\u0435\u044f","13:00 - The Jackbox Party Pack \u0441 \u042e\u0442\u0443\u0431\u0435\u0440\u0430\u043c\u0438","14:00 - Undertale Quiz","14:30 - 84 Sans AU Quiz","15:00 - \u041b\u043e\u0442\u0435\u0440\u0435\u044f","15:30 - \u041f\u0440\u0435\u0437\u0435\u043d\u0442\u0430\u0446\u0438\u0438 Undertale AU","16:30 - \u041f\u0440\u0435\u0437\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0418\u0433\u0440","17:30 - \u041b\u043e\u0442\u0435\u0440\u0435\u044f","18:00 - Everybody Switch","19:00 - \u0414\u0438\u0441\u043a\u043e\u0442\u0435\u043a\u0430","19:55 - \u0417\u0430\u043a\u0440\u044b\u0442\u0438\u0435 \u0441\u0446\u0435\u043d\u044b"],fs=["14:00 - Undercards","15:00 - Underverse Battles","11:30 - 17:00 - Endless Sans","11:30 - 17:00 - Unfair Undyne"],Ns=["13:00 - Nes - TMNT: Tournament Fighters","14:00 - Sega - Ultimate Mortal Kombat 3","15:00 - Snes - Super Tetris 3","16:00 - Ps1 - Tekken 3"],ws={user:"styles_user__WUZvf",title:"styles_title__Gd1jL",toggle:"styles_toggle__qlIwC",toggleInp:"styles_toggleInp__fGE-7",userInfo:"styles_userInfo__vgBlw",operations:"styles_operations__MGBbv"};function ks(){var e;X("Users");const s=(0,a.useQuery)("users",(async()=>await d("/api/users")));return(0,y.jsxs)(L,{centeredPage:!0,homeBtn:!0,gap:8,styles:{fontFamily:"'PT Sans', Arial"},children:[s.isLoading&&(0,y.jsx)("h3",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),b(s),null===(e=s.data)||void 0===e?void 0:e.map((e=>(0,y.jsxs)("div",{className:ws.user,children:[(0,y.jsx)("input",{type:"checkbox",className:ws.toggleInp,id:"user".concat(e.id)}),(0,y.jsxs)("label",{className:ws.title,htmlFor:"user".concat(e.id),children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{children:e.login}),(0,y.jsx)("div",{style:{color:"blue"},children:e.id}),(0,y.jsx)("div",{children:"|"}),(0,y.jsx)("div",{children:e.name})]}),(0,y.jsxs)("div",{children:[e.deleted&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{style:{color:"tomato"},children:"deleted"}),(0,y.jsx)("div",{children:"|"})]}),(0,y.jsx)("span",{children:e.roles.join(", ")}),(0,y.jsx)("div",{className:ws.toggle})]})]}),(0,y.jsx)("div",{className:ws.userInfo,children:(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{children:"Operations"}),(0,y.jsx)("div",{className:ws.operations,children:e.operations.map(((e,s)=>(0,y.jsx)("div",{children:Es(e)},s)))})]})})]},e.id)))]})}function Es(e){const s={page:"#990099",add:"#008000",get:"#008000",change:"#006fb3",delete:"#b30000"};for(const t in s)if(e.startsWith(t))return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{style:{color:s[t]},children:t}),(0,y.jsx)("span",{children:e.slice(t.length)})]});return(0,y.jsx)("span",{children:e})}const Cs={btn:"styles_btn__w12Ul"};function Ss(){return(0,y.jsxs)(L,{centered:!0,homeBtn:!0,gap:"1rem",children:[x("manage_store")&&(0,y.jsx)(I.rU,{to:"/manage_store",className:Cs.btn,children:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u043e\u043c"}),x("manage_quest")&&(0,y.jsx)(I.rU,{to:"/manage_quest",className:Cs.btn,children:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u0432\u0435\u0441\u0442\u0430\u043c\u0438"}),x("page_worker_quest")&&(0,y.jsx)(I.rU,{to:"/worker_quest",className:Cs.btn,children:"\u0414\u043b\u044f \u043a\u0432\u0435\u0441\u0442\u043e\u0432\u0438\u043a\u043e\u0432"}),x("page_worker_store")&&(0,y.jsx)(I.rU,{to:"/worker_store",className:Cs.btn,children:"\u0414\u043b\u044f \u043f\u0440\u043e\u0434\u0430\u0432\u0446\u043e\u0432"}),x("send_any")&&(0,y.jsx)(I.rU,{to:"/send",className:Cs.btn,children:"\u041a\u0430\u0437\u043d\u0430\u0447\u0435\u0439\u0441\u0442\u0432\u043e"}),x("promote_worker")&&(0,y.jsx)(I.rU,{to:"/promote_worker",className:Cs.btn,children:"\u041f\u043e\u0432\u044b\u0441\u0438\u0442\u044c \u0434\u043e \u0432\u043e\u043b\u043e\u043d\u0442\u0451\u0440\u0430"}),x("promote_manager")&&(0,y.jsx)(I.rU,{to:"/promote_manager",className:Cs.btn,children:"\u041f\u043e\u0432\u044b\u0441\u0438\u0442\u044c \u0434\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0435\u0433\u043e"}),x("manage_games")&&(0,y.jsx)(I.rU,{to:"/race_settings",className:Cs.btn,children:"\u0413\u043e\u043d\u043a\u0438"})]})}const Is={root:"styles_root__Ch43Y",quests:"styles_quests__CJF3F",quest:"styles_quest__la9IG",quest_hidden:"styles_quest_hidden__895fL",qr:"styles_qr__CpwFg",questCard:"styles_questCard__LUpC3"};function Rs(){var e,s,t,n;X("Qr \u041a\u0432\u0435\u0441\u0442\u044b");const a=ce(),l=de(!1),i=me(null,l.setT);return(0,y.jsxs)(L,{centered:!0,homeBtn:!0,gap:"1rem",height100:!0,className:Is.root,children:[a.isLoading&&(0,y.jsx)(U,{}),b(a),(0,y.jsx)("h2",{children:"\u041a\u0430\u043a\u043e\u0439 \u043a\u0432\u0435\u0441\u0442 \u0432\u044b \u043f\u0440\u043e\u0432\u043e\u0434\u0438\u0442\u0435?"}),(0,y.jsx)("div",{className:Is.quests,children:null===(e=a.data)||void 0===e?void 0:e.map((e=>(0,y.jsx)("button",{onClick:()=>i.set(e),className:f(Is.quest,e.hidden&&Is.quest_hidden),children:e.name},e.id)))}),(0,y.jsxs)(W,{title:"\u041a\u043e\u0434 \u043a\u0432\u0435\u0441\u0442\u0430",open:l.v,close:l.setF,children:[(0,y.jsx)("div",{className:Is.qr,children:(0,y.jsx)(Pe,{code:"quest_".concat(null===(s=i.v)||void 0===s?void 0:s.id_big),colorBg:"#ffffff00",scale:13})}),(0,y.jsxs)("div",{className:Is.questCard,children:[(0,y.jsx)("div",{children:null===(t=i.v)||void 0===t?void 0:t.name}),(0,y.jsxs)("div",{children:[null===(n=i.v)||void 0===n?void 0:n.reward," G"]})]}),(0,y.jsx)("h3",{children:"QR-\u043a\u043e\u0434 \u0434\u043b\u044f \u0437\u0430\u0447\u0451\u0442\u0430 \u043a\u0432\u0435\u0441\u0442\u0430"})]})]})}const Fs={items:"styles_items__ph2vL",item:"styles_item__t2Q7S",item__img:"styles_item__img__9MSeY",item__desc:"styles_item__desc__vFBVd",qr:"styles_qr__Sgcly",item_small:"styles_item_small__EPwTh"};function qs(){var e,s,t,n,a,l;X("Qr \u0422\u043e\u0432\u0430\u0440\u044b");const i=fe(),r=de(!1),c=me(null,r.setT);return(0,y.jsxs)(L,{centeredPage:!0,gap:"1rem",height100:!0,homeBtn:!0,children:[(0,y.jsx)("h1",{children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0430"}),i.isLoading&&(0,y.jsx)(U,{}),b(i),(0,y.jsx)("div",{className:Fs.items,children:null===i||void 0===i||null===(e=i.data)||void 0===e?void 0:e.map((e=>(0,y.jsxs)("button",{className:Fs.item,onClick:()=>c.set(e),children:[(0,y.jsx)("div",{className:Fs.item__img,children:e.img?(0,y.jsx)("img",{src:e.img,alt:"\u0422\u043e\u0432\u0430\u0440"}):(0,y.jsx)("div",{})}),(0,y.jsxs)("div",{className:Fs.item__desc,children:[(0,y.jsx)("span",{children:e.name}),(0,y.jsxs)("span",{children:[e.price," G"]})]})]},e.id)))}),(0,y.jsxs)(W,{title:"\u041a\u043e\u0434 \u0442\u043e\u0432\u0430\u0440\u0430",open:r.v,close:r.setF,children:[(0,y.jsx)("div",{className:Fs.qr,children:(0,y.jsx)(Pe,{code:"item_".concat(null===(s=c.v)||void 0===s?void 0:s.id_big),colorBg:"#ffffff00",scale:13})}),(0,y.jsxs)("div",{className:Fs.item_small,children:[(0,y.jsx)("div",{className:Fs.item__img,children:null!==(t=c.v)&&void 0!==t&&t.img?(0,y.jsx)("img",{src:null===(n=c.v)||void 0===n?void 0:n.img,alt:"\u0422\u043e\u0432\u0430\u0440"}):(0,y.jsx)("div",{})}),(0,y.jsx)("div",{children:null===(a=c.v)||void 0===a?void 0:a.name}),(0,y.jsxs)("div",{children:[null===(l=c.v)||void 0===l?void 0:l.price," G"]})]}),(0,y.jsx)("h3",{children:"QR-\u043a\u043e\u0434 \u0434\u043b\u044f \u043f\u0440\u043e\u0434\u0430\u0436\u0438 \u0442\u043e\u0432\u0430\u0440\u0430"})]})]})}const Qs={root:"styles_root__xVfBI",background:"styles_background__-JNpx",title:"styles_title__ljziD",subtitle:"styles_subtitle__A04gi",text:"styles_text__euwMB",yellow:"styles_yellow__WFShd",snail1:"styles_snail1__Y18cj",snail2:"styles_snail2__uNJxO",snail3:"styles_snail3__jwEQm",snail4:"styles_snail4__pdJVk",ghost:"styles_ghost__rau2a",snail2_2:"styles_snail2_2__I6rzv",snail5:"styles_snail5__6P6qN",snail6:"styles_snail6__2ST1L",snails:"styles_snails__K4WQm",join:"styles_join__Bq7Wz",join__btns:"styles_join__btns__Vxizc",btn_blue:"styles_btn_blue__Wtbhw",btn_red:"styles_btn_red__30YIL",btn_yellow:"styles_btn_yellow__MvHG4",btn_green:"styles_btn_green__OuaDM",selectedTeam:"styles_selectedTeam__JnyJ-",joinBtn:"styles_joinBtn__iT+bj",press:"styles_press__qtwfs",circle:"styles_circle__t9e+q","anim-circle":"styles_anim-circle__B-OlB"},Us=t.p+"static/media/banner.35e275b252c8f3a946d0.png",Ms="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAADFAgMAAAAwDtSyAAAAAXNSR0IB2cksfwAAAAlwSFlzAABcRgAAXEYBFJRDQQAAAAlQTFRF////AAAAAAAAflGpXQAAAAN0Uk5T//8A18oNQQAAAKJJREFUeJzt2MENgzAMBVDnwAjZJyPkgHvoCEzRJToCh2ZK7CQgKJeqFz7S/7f4XaxIQdhStszqmdbjS7DI6lk8cVUw6vWW+ICjWeWQ4P0j0aFzQPruvMZumPQzne62JWjCIv8E5VqxJNJflKVTCiTSZQTyHO5Mp5BIJBKJRCLB06BbBY3avKzPunmwMfk9uuxG6eupFPsl7Osv33p9+o4OhRaL1PXeOAlCagAAAABJRU5ErkJggg==",Bs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdkAAACcAQMAAAAJa0MqAAAAAXNSR0IB2cksfwAAAAlwSFlzAABcRgAAXEYBFJRDQQAAAAZQTFRF////AAAAVcLTfgAAAAJ0Uk5T/wDltzBKAAAAsklEQVR4nO3YQQ6DIBCF4Wm68FgerRyVY3RhOh1hiFg1UWOtTf7ZTODxEVZEFN1TUURaDQIGg4/GfdnwZe1u/Wm9mSy2yZu1LodR6prgaPuW6g8HBoN/jMV5SDEYDP4L7EnGnnr80NGSLg3AYPDVcP2xvog/9geDwadg1Wphfv4OYSi4cDAY/GUs42q24rnLoE1nAIPB52D1bC2unsBgMPiiWFK66ZfWcJOAwWAwGAxewG93yWoXksF15gAAAABJRU5ErkJggg==";function Ts(){const e=(0,a.useQueryClient)();return(0,a.useQuery)("raceState",(async()=>{const s=await d("/api/race/state");return e.setQueryData("user",(e=>({...e,balance:s.balance}))),s}))}function Ls(){return(0,a.useQuery)("raceDuration",(async()=>await d("/api/race/duration")))}function Ds(){var e,s,t,n,l,i,r,c,o;X("\u0413\u043e\u043d\u043a\u0438");const d=Ts(),m=function(e,s){const t=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>await u("/api/race/join",{team:e}),onSuccess:s=>{t.setQueryData("raceState",s),t.setQueryData("user",(e=>({...e,balance:s.balance}))),null===e||void 0===e||e()},onError:s})}(),h=me(""),v=me(0);return(0,j.useEffect)((()=>{var e,s,t;if("title"!=(null===(e=d.data)||void 0===e?void 0:e.state)&&"play"!=(null===(s=d.data)||void 0===s?void 0:s.state)&&"nojoin"!=(null===(t=d.data)||void 0===t?void 0:t.state))return;const n=setInterval((()=>d.refetch()),5e3);return()=>clearInterval(n)}),[d.data]),(0,j.useEffect)((()=>{if(d.data&&(v.set(d.data.counter),d.data.counter>0)){const e=setInterval((()=>{v.set((s=>(0==(s=Math.max(s-1,0))&&(d.refetch(),clearInterval(e)),s)))}),1e3);return()=>clearInterval(e)}}),[d.data]),(0,y.jsxs)(L,{centeredPage:!0,headerColor:"#512d00",gap:"1em",className:Qs.root,footer:(0,y.jsx)(Te,{curPage:"race"}),children:[(0,y.jsx)("div",{className:Qs.background}),d.isLoading&&(0,y.jsx)(U,{}),m.isLoading&&(0,y.jsx)(U,{}),b(d),b(m),(d.isLoading||"title"==(null===(e=d.data)||void 0===e?void 0:e.state))&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:Qs.snail5}),(0,y.jsx)("div",{className:Qs.snail6}),(0,y.jsx)("div",{className:Qs.ghost}),(0,y.jsx)("h1",{className:Qs.title,children:"Underparty"}),(0,y.jsx)("div",{className:Qs.text,children:(0,y.jsxs)("div",{className:Qs.snail4,children:[(0,y.jsx)("span",{className:Qs.snail1,children:"\u0414\u043b\u044f"}),(0,y.jsx)("span",{children:" \u0443\u0447\u0430\u0441\u0442\u0438\u044f "}),(0,y.jsx)("span",{className:Qs.snail2,children:"\u0432"}),(0,y.jsx)("span",{children:" \u0433\u043e\u043d\u043a\u0435 \u043f\u0440\u0438\u0445\u043e\u0434\u0438\u0442\u0435 \u043d\u0430 "}),(0,y.jsx)("span",{className:Qs.yellow,children:"\u0413\u043b\u0430\u0432\u043d\u0443\u044e\xa0\xa0\u0441\u0446\u0435\u043d\u0443"}),(null===(s=d.data)||void 0===s?void 0:s.start)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{children:" \u0432 "}),(0,y.jsx)("span",{className:f(Qs.yellow,Qs.snail3),children:d.data.start})]})]})})]}),"wait"==(null===(t=d.data)||void 0===t?void 0:t.state)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:Qs.snail2_2}),(0,y.jsx)("div",{className:Qs.snail6}),(0,y.jsx)("h1",{className:Qs.title,children:"Underparty"}),(0,y.jsx)("img",{src:Us,alt:"\u0413\u043e\u043d\u043a\u0438 \u0443\u043b\u0438\u0442\u043e\u043a"}),(0,y.jsx)("h2",{className:Qs.subtitle,children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u043d\u0430\u0447\u0430\u043b\u0430"}),(0,y.jsxs)("h1",{className:Qs.title,children:[Math.floor(v.v/60),":",(v.v%60).toString().padStart(2,"0")]}),(0,y.jsxs)("div",{className:Qs.snails,children:[(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{})]})]}),"join"==(null===(n=d.data)||void 0===n?void 0:n.state)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:Qs.snail2_2}),(0,y.jsx)("h1",{className:Qs.title,children:"Underparty"}),(0,y.jsxs)("h1",{className:Qs.title,children:[Math.floor(v.v/60),":",(v.v%60).toString().padStart(2,"0")]}),(0,y.jsxs)("div",{className:Qs.join,children:[(0,y.jsx)("h2",{className:Qs.subtitle,children:"\u0423\u0447\u0430\u0441\u0442\u0438\u0435"}),(0,y.jsxs)("h2",{className:f(Qs.subtitle,Qs.yellow),children:[d.data.price,"G"]}),(0,y.jsxs)("div",{className:Qs.join__btns,children:[(0,y.jsx)("button",{className:f(Qs.btn_blue,"blue"==h.v&&Qs.selectedTeam),onClick:()=>h.set("blue"),children:"\u0421\u0438\u043d\u0438\u0439"}),(0,y.jsx)("button",{className:f(Qs.btn_red,"red"==h.v&&Qs.selectedTeam),onClick:()=>h.set("red"),children:"\u041a\u0440\u0430\u0441\u043d\u044b\u0439"}),(0,y.jsx)("div",{color:h.v,children:(0,y.jsx)("img",{src:Ms,alt:"\u041f\u0440\u0438\u0437\u0440\u0430\u043a"})}),(0,y.jsx)("button",{className:f(Qs.btn_yellow,"yellow"==h.v&&Qs.selectedTeam),onClick:()=>h.set("yellow"),children:"\u0416\u0451\u043b\u0442\u044b\u0439"}),(0,y.jsx)("button",{className:f(Qs.btn_green,"green"==h.v&&Qs.selectedTeam),onClick:()=>h.set("green"),children:"\u0417\u0435\u043b\u0451\u043d\u044b\u0439"})]}),(0,y.jsx)("button",{className:Qs.joinBtn,onClick:()=>{""!=h.v&&m.mutate(h.v)},disabled:"idle"!=m.status,children:"\u041f\u0440\u0438\u043d\u044f\u0442\u044c \u0443\u0447\u0430\u0441\u0442\u0438\u0435"})]})]}),"play"==(null===(l=d.data)||void 0===l?void 0:l.state)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:Qs.snail2_2}),(0,y.jsx)("h1",{className:Qs.title,children:"Underparty"}),(0,y.jsx)("div",{className:Qs.press,children:(0,y.jsx)("button",{onClick:e=>{!function(e){const s=e instanceof HTMLButtonElement?e:e.parentElement,t=document.createElement("div");s.appendChild(t),t.classList.add(Qs.circle),setTimeout((()=>s.removeChild(t)),1e3)}(e.target)},children:(0,y.jsx)("img",{src:Bs,alt:"\u0416\u043c\u0438!"})})})]}),"nojoin"==(null===(i=d.data)||void 0===i?void 0:i.state)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:Qs.snail2_2}),(0,y.jsx)("h1",{className:Qs.title,children:"Underparty"}),(0,y.jsx)("h1",{className:Qs.title,children:"\u0418\u0433\u0440\u0430 \u0438\u0434\u0451\u0442!"}),(0,y.jsx)("h2",{className:Qs.subtitle,children:"\u0412\u044b \u043d\u0435 \u0443\u0441\u043f\u0435\u043b\u0438 \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f"}),(0,y.jsxs)("div",{className:Qs.snails,children:[(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{})]})]}),"won"==(null===(r=d.data)||void 0===r?void 0:r.state)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:Qs.snail2_2}),(0,y.jsx)("h1",{className:Qs.title,children:"Underparty"}),(0,y.jsx)("h1",{className:Qs.title,children:"\u041f\u043e\u0431\u0435\u0434\u0430!"}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:Qs.subtitle,children:"\u0412\u044b \u0432\u044b\u0438\u0433\u0440\u0430\u043b\u0438:"}),(0,y.jsx)("h2",{className:f(Qs.subtitle,Qs.yellow),children:"10G"})]}),(0,y.jsxs)("div",{className:Qs.snails,children:[(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{})]})]}),"loss"==(null===(c=d.data)||void 0===c?void 0:c.state)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:Qs.snail2_2}),(0,y.jsx)("h1",{className:Qs.title,children:"Underparty"}),(0,y.jsx)("h1",{className:Qs.title,children:"\u041f\u0440\u043e\u0438\u0433\u0440\u044b\u0448!"}),(0,y.jsx)("h2",{className:Qs.subtitle,children:"\u041f\u043e\u0432\u0435\u0437\u0451\u0442 \u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0440\u0430\u0437"}),(0,y.jsxs)("div",{className:Qs.snails,children:[(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{})]})]}),"end"==(null===(o=d.data)||void 0===o?void 0:o.state)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:Qs.snail2_2}),(0,y.jsx)("h1",{className:Qs.title,children:"Underparty"}),(0,y.jsx)("h1",{className:Qs.title,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e!"}),(0,y.jsx)("h2",{className:Qs.subtitle,children:"\u041f\u043e\u0443\u0447\u0430\u0441\u0442\u0432\u0443\u0435\u0442\u0435 \u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0440\u0430\u0437"}),(0,y.jsxs)("div",{className:Qs.snails,children:[(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{})]})]})]})}const Ps={input:"styles_input__QXsYk",openScreen:"styles_openScreen__d6UYx",start:"styles_start__lVxAx"};function Js(){X("\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0433\u043e\u043d\u043e\u043a");const e=Ls(),s=(0,a.useQuery)("raceCounter",(async()=>await d("/api/race/counter"))),t=(0,a.useQuery)("racePrice",(async()=>await d("/api/race/price"))),n=(0,a.useQuery)("raceStartStr",(async()=>await d("/api/race/startStr"))),l=function(e,s){const t=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>await u("/api/race/duration",{duration:e}),onSuccess:s=>{t.setQueryData("raceDuration",s),null===e||void 0===e||e(s)},onError:s})}(),i=function(e,s){const t=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>await u("/api/race/counter",{counter:e}),onSuccess:s=>{t.setQueryData("raceCounter",s),null===e||void 0===e||e(s)},onError:s})}(),c=function(e,s){const t=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>await u("/api/race/price",{price:e}),onSuccess:s=>{t.setQueryData("racePrice",s),null===e||void 0===e||e(s)},onError:s})}(),o=function(e,s){const t=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>await u("/api/race/startStr",{startStr:e}),onSuccess:s=>{t.setQueryData("raceStartStr",s),null===e||void 0===e||e(s)},onError:s})}(),m=me(0),h=me(0),v=me(0),x=me(""),_=de(!1),g=de(!1),p=de(!1),A=de(!1),f=function(e,s){return(0,a.useMutation)({mutationFn:async()=>await r("/api/race/start"),onSuccess:e,onError:s})}(g.setT),N=function(e,s){return(0,a.useMutation)({mutationFn:async()=>await r("/api/race/reset"),onSuccess:e,onError:s})}(A.setT);return(0,j.useEffect)((()=>{var s;return m.set((null===(s=e.data)||void 0===s?void 0:s.duration)||0)}),[e.data]),(0,j.useEffect)((()=>{var e;return h.set((null===(e=s.data)||void 0===e?void 0:e.counter)||0)}),[s.data]),(0,j.useEffect)((()=>{var e;return v.set((null===(e=t.data)||void 0===e?void 0:e.price)||0)}),[t.data]),(0,j.useEffect)((()=>{var e;return x.set((null===(e=n.data)||void 0===e?void 0:e.startStr)||"")}),[n.data]),(0,y.jsxs)(L,{centeredPage:!0,homeBtn:!0,gap:"2rem",children:[(0,y.jsx)("h1",{children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0433\u043e\u043d\u043e\u043a"}),f.isLoading&&(0,y.jsx)(U,{}),e.isLoading&&(0,y.jsx)(U,{}),s.isLoading&&(0,y.jsx)(U,{}),l.isLoading&&(0,y.jsx)(U,{}),i.isLoading&&(0,y.jsx)(U,{}),c.isLoading&&(0,y.jsx)(U,{}),o.isLoading&&(0,y.jsx)(U,{}),N.isLoading&&(0,y.jsx)(U,{}),t.isLoading&&(0,y.jsx)(U,{}),n.isLoading&&(0,y.jsx)(U,{}),b(f),b(e),b(s),b(l),b(i),b(N),b(t),b(o),(0,y.jsx)(I.rU,{to:"/race_screen",className:Ps.openScreen,children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u044d\u043a\u0440\u0430\u043d"}),(0,y.jsxs)("div",{className:Ps.input,children:[(0,y.jsx)("span",{children:"\u0412\u0440\u0435\u043c\u044f \u043d\u0430\u0447\u0430\u043b\u0430"}),(0,y.jsx)("input",{type:"text",value:x.v,onChange:e=>x.set(e.target.value)}),n.data&&x.v!=n.data.startStr&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("button",{onClick:()=>o.mutate(x.v),children:(0,y.jsx)(ge,{})}),(0,y.jsx)("button",{onClick:()=>x.set(n.data.startStr),children:(0,y.jsx)(ye,{})})]})]}),(0,y.jsxs)("div",{className:Ps.input,children:[(0,y.jsx)("span",{children:"\u0426\u0435\u043d\u0430 \u0443\u0447\u0430\u0441\u0442\u0438\u044f"}),(0,y.jsx)("input",{type:"number",value:v.v,onChange:e=>v.set(e.target.valueAsNumber)}),t.data&&v.v!=t.data.price&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("button",{onClick:()=>c.mutate(v.v),children:(0,y.jsx)(ge,{})}),(0,y.jsx)("button",{onClick:()=>v.set(t.data.price),children:(0,y.jsx)(ye,{})})]})]}),(0,y.jsxs)("div",{className:Ps.input,children:[(0,y.jsx)("span",{children:"\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0438\u0433\u0440\u044b (\u0441\u0435\u043a.)"}),(0,y.jsx)("input",{type:"number",value:m.v,onChange:e=>m.set(e.target.valueAsNumber)}),e.data&&m.v!=e.data.duration&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("button",{onClick:()=>l.mutate(m.v),children:(0,y.jsx)(ge,{})}),(0,y.jsx)("button",{onClick:()=>m.set(e.data.duration),children:(0,y.jsx)(ye,{})})]})]}),(0,y.jsxs)("div",{className:Ps.input,children:[(0,y.jsx)("span",{children:"\u041e\u0431\u0440\u0430\u0442\u043d\u044b\u0439 \u043e\u0442\u0441\u0447\u0451\u0442 (\u0441\u0435\u043a.)"}),(0,y.jsx)("input",{type:"number",value:h.v,onChange:e=>h.set(e.target.valueAsNumber)}),s.data&&h.v!=s.data.counter&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("button",{onClick:()=>i.mutate(h.v),children:(0,y.jsx)(ge,{})}),(0,y.jsx)("button",{onClick:()=>h.set(s.data.counter),children:(0,y.jsx)(ye,{})})]})]}),(0,y.jsx)("button",{className:Ps.start,onClick:_.setT,children:"\u0421\u0442\u0430\u0440\u0442!"}),(0,y.jsx)("button",{className:Ps.start,onClick:p.setT,children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c"}),(0,y.jsxs)(W,{open:_.v,close:_.setF,closeOnOutclick:!0,children:[(0,y.jsx)("h2",{children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0433\u043e\u043d\u043a\u0443?"}),(0,y.jsx)("br",{}),(0,y.jsx)("button",{className:Ps.start,onClick:()=>{_.setF(),f.mutate()},children:"\u041d\u0430\u0447\u0430\u0442\u044c"})]}),(0,y.jsx)(W,{open:g.v,close:g.setF,closeOnOutclick:!0,children:(0,y.jsx)("h2",{children:"\u0413\u043e\u043d\u043a\u0430 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430!"})}),(0,y.jsxs)(W,{open:p.v,close:p.setF,closeOnOutclick:!0,children:[(0,y.jsx)("h2",{children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0433\u043e\u043d\u043a\u0443?"}),(0,y.jsx)("br",{}),(0,y.jsx)("button",{className:Ps.start,onClick:()=>{p.setF(),N.mutate()},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c"})]}),(0,y.jsx)(W,{open:A.v,close:A.setF,closeOnOutclick:!0,children:(0,y.jsx)("h2",{children:"\u0413\u043e\u043d\u043a\u0430 \u0441\u0431\u0440\u043e\u0448\u0435\u043d\u0430!"})})]})}const Xs={root:"styles_root__hjoy4",soundBtn:"styles_soundBtn__grYPt",field:"styles_field__CTHs3",background:"styles_background__24NYI",snail1:"styles_snail1__mYkpJ",snail2:"styles_snail2__+NEXt",snail3:"styles_snail3__tIvFR",snail4:"styles_snail4__zW3kw",snailAnim:"styles_snailAnim__ZLbFQ","anim-snail1":"styles_anim-snail1__+58Yx","anim-snail2":"styles_anim-snail2__JRjtv","anim-snail3":"styles_anim-snail3__V0LqY","anim-snail4":"styles_anim-snail4__51knm",msg:"styles_msg__FzWR5",c_yellow:"styles_c_yellow__WKLkm",c_blue:"styles_c_blue__w+o2w",c_red:"styles_c_red__TuI+D",c_green:"styles_c_green__nBLJ+"},Vs="data:image/png;base64,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",Os=t.p+"static/media/ost.03d920d73af9d5efa36e.mp3";let Zs=0;const Gs=250;function zs(e){return new Promise((s=>setTimeout(s,e)))}function Hs(e,s){return Math.abs(e-s)<1e-5}const Ws=472/629;function Ys(){var e,s,t,n,l,i,r,c,o;X("\u0413\u043e\u043d\u043a\u0438");const d=Ls(),m=function(e,s){const t=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>await u("/api/race/finish",{team:e}),onSuccess:s=>{t.setQueryData("raceState",s),null===e||void 0===e||e()},onError:s})}(),h=function(e){const s=Gs/(1e3*e),t=me({title:"",t:0,snail1:0,snail2:0,snail3:0,snail4:0,snailA1:1,snailA2:1,snailA3:1,snailA4:1,snailB1:1,snailB2:1,snailB3:1,snailB4:1,snailD1:1,snailD2:1,snailD3:1,snailD4:1,started:!1,winner:""});return{title:t.v.title,start:async()=>{const e=++Zs;if(t.set((e=>({...e,title:"3..."}))),await zs(1500),Zs==e&&(t.set((e=>({...e,title:"2..."}))),await zs(1500),Zs==e&&(t.set((e=>({...e,title:"1..."}))),await zs(1500),Zs==e)))for(t.set((e=>({...e,title:"",started:!0,t:0,snailA1:.75*Math.random()+.5,snailA2:.75*Math.random()+.5,snailA3:.75*Math.random()+.5,snailA4:.75*Math.random()+.5,snailB1:.25*Math.random()+.75,snailB2:.25*Math.random()+.75,snailB3:.25*Math.random()+.75,snailB4:.25*Math.random()+.75,snailD1:.1*Math.random()-.05,snailD2:.1*Math.random()-.05,snailD3:.1*Math.random()-.05,snailD4:.1*Math.random()-.05})));;){if(Zs!=e)return;t.set((e=>{const t=e.t+s,n=Math.min(t/.8,1),a=Math.min(Math.abs(t-.5)/.5,1),l=Math.max(t-.7,0)/(1-.7),i=t*(e.snailA1*(1-n)+n)*(e.snailB1*(1-a)+a)+e.snailD1*l,r=t*(e.snailA2*(1-n)+n)*(e.snailB2*(1-a)+a)+e.snailD2*l,c=t*(e.snailA3*(1-n)+n)*(e.snailB3*(1-a)+a)+e.snailD3*l,o=t*(e.snailA4*(1-n)+n)*(e.snailB4*(1-a)+a)+e.snailD4*l,d=Math.max(i,r,c,o);let u="blue";return Hs(i,d)&&(u="yellow"),Hs(r,d)&&(u="blue"),Hs(c,d)&&(u="red"),Hs(o,d)&&(u="green"),t>=1&&Zs++,{...e,t:t,snail1:i,snail2:r,snail3:c,snail4:o,started:t<1,winner:t<1?"":u,title:t<1?"":"\u0424\u0438\u043d\u0438\u0448!"}})),await zs(Gs)}},snail1:t.v.snail1,snail2:t.v.snail2,snail3:t.v.snail3,snail4:t.v.snail4,started:t.v.started,winner:t.v.winner}}((null===(e=d.data)||void 0===e?void 0:e.duration)||10),v=Ts(),x=ns(Os,!0),_=de(!1),g=me(0),p=me(0);return(0,j.useEffect)((()=>{let e=window.innerWidth;e*Ws>window.innerHeight&&(e=window.innerHeight/Ws),g.set(e-30)}),[]),(0,j.useEffect)((()=>{var e,s,t;if("play"==(null===(e=v.data)||void 0===e?void 0:e.state)||"nojoin"==(null===(s=v.data)||void 0===s?void 0:s.state))return void h.start();if("title"!=(null===(t=v.data)||void 0===t?void 0:t.state))return;const n=setInterval((()=>v.refetch()),5e3);return()=>clearInterval(n)}),[v.data]),(0,j.useEffect)((()=>{var e,s;if("join"!=(null===(e=v.data)||void 0===e?void 0:e.state)&&"wait"!=(null===(s=v.data)||void 0===s?void 0:s.state))return;p.set(v.data.counter),d.refetch();const t=setInterval((()=>{p.set((e=>(0==(e=Math.max(e-1,0))&&(v.refetch(),clearInterval(t)),e)))}),1e3);return()=>clearInterval(t)}),[v.data]),(0,j.useEffect)((()=>{""!=h.winner&&m.mutate(h.winner)}),[h.winner]),(0,y.jsxs)("div",{className:Xs.root,children:[!_.v&&(0,y.jsx)("button",{className:Xs.soundBtn,onClick:()=>{_.setT(),x()},children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0437\u0432\u0443\u043a"}),(0,y.jsxs)("div",{className:Xs.field,style:{width:g.v,height:g.v*Ws,minWidth:g.v,minHeight:g.v*Ws,"--w":g.v},children:[(0,y.jsx)("img",{className:Xs.background,src:Vs,alt:"\u041f\u043e\u043b\u0435"}),(0,y.jsx)("div",{className:f(Xs.snail1,h.started&&Xs.snailAnim),style:{right:Ks(h.snail1)}}),(0,y.jsx)("div",{className:f(Xs.snail2,h.started&&Xs.snailAnim),style:{right:Ks(h.snail2)}}),(0,y.jsx)("div",{className:f(Xs.snail3,h.started&&Xs.snailAnim),style:{right:Ks(h.snail3)}}),(0,y.jsx)("div",{className:f(Xs.snail4,h.started&&Xs.snailAnim),style:{right:Ks(h.snail4)}}),("play"!=(null===(s=v.data)||void 0===s?void 0:s.state)&&"nojoin"!=(null===(t=v.data)||void 0===t?void 0:t.state)||h.title)&&(0,y.jsxs)("div",{className:Xs.msg,children:["title"==(null===(n=v.data)||void 0===n?void 0:n.state)&&(0,y.jsx)("span",{children:"\u0421\u043a\u043e\u0440\u043e \u043d\u0430\u0447\u0430\u043b\u043e!"}),("join"==(null===(l=v.data)||void 0===l?void 0:l.state)||"wait"==(null===(i=v.data)||void 0===i?void 0:i.state))&&(0,y.jsxs)("span",{children:[Math.floor(p.v/60),":",(p.v%60).toString().padStart(2,"0")]}),"won"==(null===(r=v.data)||void 0===r?void 0:r.state)||"loss"==(null===(c=v.data)||void 0===c?void 0:c.state)||"end"==(null===(o=v.data)||void 0===o?void 0:o.state)?(0,y.jsxs)("span",{children:["\u041f\u043e\u0431\u0435\u0434\u0438\u0442\u0435\u043b\u044c: ",{yellow:(0,y.jsx)("span",{className:Xs.c_yellow,children:"\u0416\u0451\u043b\u0442\u044b\u0439"}),blue:(0,y.jsx)("span",{className:Xs.c_blue,children:"\u0421\u0438\u043d\u0438\u0439"}),red:(0,y.jsx)("span",{className:Xs.c_red,children:"\u041a\u0440\u0430\u0441\u043d\u044b\u0439"}),green:(0,y.jsx)("span",{className:Xs.c_green,children:"\u0417\u0435\u043b\u0451\u043d\u044b\u0439"}),"":""}[v.data.winner]]}):h.title&&(0,y.jsx)("span",{children:h.title})]})]})]})}function Ks(e){return 69*e+16+"%"}function $s(){var e,s;const t=m();function a(e,s,a){var l;return(0,y.jsx)(n.AW,{path:s,element:null!==(l=t.data)&&void 0!==l&&l.auth?null==e||v(t,e)?a:(0,y.jsx)(P,{}):(0,y.jsx)(n.Fg,{to:"/"})})}return(0,y.jsxs)("div",{className:"root",children:[(0,y.jsx)(g,{}),(0,y.jsx)(k,{}),t.isLoading&&(0,y.jsx)(_.Z,{}),b(t),t.isSuccess&&(0,y.jsxs)(n.Z5,{children:[(0,y.jsx)(n.AW,{path:"/",element:null!==(e=t.data)&&void 0!==e&&e.auth?(0,y.jsx)(n.Fg,{to:"/map"}):(0,y.jsx)(se,{})}),(0,y.jsx)(n.AW,{path:"/auth",element:null!==(s=t.data)&&void 0!==s&&s.auth?(0,y.jsx)(n.Fg,{to:"/"}):(0,y.jsx)(G,{})}),(0,y.jsx)(n.AW,{path:"/timetable",element:(0,y.jsx)(ps,{})}),(0,y.jsx)(n.AW,{path:"/quest",element:(0,y.jsx)(We,{})}),(0,y.jsx)(n.AW,{path:"/store",element:(0,y.jsx)(gs,{})}),(0,y.jsx)(n.AW,{path:"/map",element:(0,y.jsx)(Le,{})}),(0,y.jsx)(n.AW,{path:"/race",element:(0,y.jsx)(Ds,{})}),a(null,"/scanner",(0,y.jsx)(hs,{})),a("page_worker","/worker",(0,y.jsx)(Ss,{})),a("manage_store","/manage_store",(0,y.jsx)(Fe,{})),a("manage_quest","/manage_quest",(0,y.jsx)(Ae,{})),a("manage_games","/race_settings",(0,y.jsx)(Js,{})),a("manage_games","/race_screen",(0,y.jsx)(Ys,{})),a("page_worker_quest","/worker_quest",(0,y.jsx)(Rs,{})),a("page_worker_store","/worker_store",(0,y.jsx)(qs,{})),a("promote_worker","/promote_worker",(0,y.jsx)(Xe,{role:"worker"})),a("promote_manager","/promote_manager",(0,y.jsx)(Xe,{role:"manager"})),a("send_any","/send",(0,y.jsx)(xs,{})),a("page_debug","/debug",(0,y.jsx)(Y,{})),a("page_debug","/log",(0,y.jsx)(ie,{})),a("page_users","/users",(0,y.jsx)(ks,{})),(0,y.jsx)(n.AW,{path:"*",element:(0,y.jsx)(D,{})})]})]})}}}]);
//# sourceMappingURL=658.edee65fe.chunk.js.map