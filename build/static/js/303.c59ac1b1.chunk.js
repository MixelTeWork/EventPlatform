"use strict";(self.webpackChunkevent_platform=self.webpackChunkevent_platform||[]).push([[303],{1998:(e,s,t)=>{t.r(s),t.d(s,{default:()=>Ye});var n=t(7689),l=t(1933);class r extends Error{}async function i(e,s,t){const n=await fetch(s,{method:e,headers:{"Content-Type":"application/json"},body:void 0===t?null:JSON.stringify(t)});if(!n.ok)throw new r((await n.json()).msg);return n}function a(e,s){return i("POST",e,s)}async function o(e,s,t){const n=await i(e,s,t);return await n.json()}function c(e,s){return o("GET",e,s)}function d(e,s){return o("POST",e,s)}function u(){return(0,l.useQuery)("user",h)}async function h(){const e=await fetch("/api/user"),s=await e.json();if(401==e.status)return{auth:!1,id:-1,balance:0,login:"",roles:[],name:"",operations:[]};if(!e.ok)throw new r(s.msg);const t=s;return t.auth=!0,t}function _(e,s){var t,n;return!(null===(t=e.data)||void 0===t||!t.auth||null===(n=e.data)||void 0===n||!n.operations.includes(s))}function m(e){return _(u(),e)}var x=t(5086),f=t(2791);function j(){const{pathname:e}=(0,n.TH)();return(0,f.useEffect)((()=>{window.scrollTo(0,0)}),[e]),null}var v=t(184);function g(e,s){const t=e instanceof r?e.message:"\u041e\u0448\u0438\u0431\u043a\u0430";return s?s(t):t}function p(e,s,t){if(!e.isError)return null;return(s||A)(g(e,t))}function A(e){return(0,v.jsx)("h3",{style:{color:"tomato",textAlign:"center"},children:e})}function y(){for(var e=arguments.length,s=new Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter((e=>!!e)).join(" ")}const b={root:"styles_root__hzHjz",visible:"styles_visible__6aD-n",close:"styles_close__3L8iW",message:"styles_message__oF8zk"};let H="";function N(){const[e,s]=(0,f.useState)("");return(0,f.useEffect)((()=>{const e=setInterval((()=>{const e=function(e){let s=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return s?decodeURIComponent(s[1]):void 0}("MESSAGE_TO_FRONTEND");e!=H&&(H=e||"",s(H))}),1e3);return()=>{clearInterval(e)}}),[s]),(0,v.jsxs)("div",{className:y(b.root,""!=e&&b.visible),children:[(0,v.jsx)("button",{className:b.close,onClick:()=>s("")}),(0,v.jsx)("div",{className:b.message,children:w(e)})]})}function w(e){return'"'==e.at(0)&&(e=e.slice(1)),'"'==e.at(-1)&&(e=e.slice(0,-1)),e}const k={root:"styles_root__4DGhY"};function S(){const e=(0,n.s0)();return(0,v.jsx)("div",{className:k.root,children:(0,v.jsx)("button",{onClick:()=>e(-1),className:"button button_light",children:"\u041d\u0430\u0437\u0430\u0434"})})}var C=t(1087);const I={root:"styles_root__Zvl9c",home:"styles_home__o+-s7",block:"styles_block__a1SM7",balance:"styles_balance__PLLCC",user:"styles_user__0ltHf",menu:"styles_menu__WWgPh",menuVisible:"styles_menuVisible__mMGZn"};async function E(e){const s=await d("/api/auth",e);return s.auth=!0,s}async function Q(){await a("/api/logout")}const L={root:"styles_root__BdzzK",spinner:"styles_spinner__rlI86","lds-ring":"styles_lds-ring__jnLuB"};function P(e){let{color:s,zIndex:t}=e;return(0,v.jsx)("div",{className:L.root,children:(0,v.jsxs)("div",{className:L.spinner,style:{"--color":s,zIndex:t},children:[(0,v.jsx)("div",{}),(0,v.jsx)("div",{}),(0,v.jsx)("div",{}),(0,v.jsx)("div",{})]})})}function q(){var e,s,t;const[r,i]=(0,f.useState)(!1),a=(0,n.s0)(),o=function(e){const s=(0,l.useQueryClient)();return(0,l.useMutation)({mutationFn:Q,onSuccess:()=>{s.setQueryData("user",(e=>({auth:!1,id:-1,balance:0,login:"",roles:[],name:"",operations:[]}))),s.setQueryData("quests",(e=>(null===e||void 0===e||e.forEach((e=>e.completed=!1)),e||[]))),null===e||void 0===e||e()}})}((()=>{i(!1)})),c=u();return(0,v.jsxs)("div",{className:I.root,children:[(0,v.jsx)(C.rU,{to:"/",className:y(I.home,"material_symbols"),children:"home"}),(0,v.jsxs)("span",{className:I.block,children:[(0,v.jsxs)("div",{className:I.balance,children:[(null===(e=c.data)||void 0===e?void 0:e.balance)||0," G"]}),(0,v.jsx)("button",{className:I.user,onClick:()=>{var e;return null!==(e=c.data)&&void 0!==e&&e.auth?i((e=>!e)):a("/login")},children:(0,v.jsx)("span",{children:null!==(s=c.data)&&void 0!==s&&s.auth?null===(t=c.data)||void 0===t?void 0:t.name:"\u0412\u043e\u0439\u0442\u0438"})}),(0,v.jsxs)("div",{className:y(I.menu,r&&I.menuVisible),children:[(0,v.jsx)("button",{onClick:()=>a("/profile"),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),_(c,"page_debug")&&(0,v.jsx)(C.rU,{to:"/debug",children:"</>"}),_(c,"page_worker")&&(0,v.jsx)(C.rU,{to:"/worker",className:"material_symbols",children:"deployed_code"}),(0,v.jsx)("button",{onClick:()=>o.mutate(),disabled:"idle"!=o.status,children:"\u0412\u044b\u0439\u0442\u0438"})]})]}),"loading"==o.status&&(0,v.jsx)(P,{})]})}const F={root:"styles_root__xvR2N",hasFooter:"styles_hasFooter__lMS3o",body:"styles_body__S-p4X",body_centered:"styles_body_centered__NzRPU",body_centeredPage:"styles_body_centeredPage__R-EzO"};function O(e){let{children:s,className:t,styles:n,centered:l=!1,centeredPage:r=!1,height100:i=!1,gap:a=0,header:o,footer:c}=e;return void 0===o&&(o=(0,v.jsx)(q,{})),(0,v.jsxs)("div",{className:y(F.root,!!c&&F.hasFooter),style:{...n,maxHeight:i?"100dvh":""},children:[o||(0,v.jsx)("div",{}),(0,v.jsx)("div",{className:y(F.body,t,l&&F.body_centered,r&&F.body_centeredPage),style:{gap:a,maxHeight:i?"100%":""},children:s}),c]})}function T(){return(0,v.jsx)(O,{centered:!0,header:(0,v.jsx)(S,{}),children:"\u0422\u0430\u043a\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u043d\u0435\u0442"})}function B(){return(0,v.jsx)(O,{centered:!0,header:(0,v.jsx)(S,{}),children:"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u0442\u043e\u0447\u043d\u043e \u043f\u0440\u0430\u0432 \u043d\u0430 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b"})}const U={back:"styles_back__uuJZO",form:"styles_form__n7Rcu"};function D(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435";(0,f.useEffect)((()=>{const t=document.title,n="object"!=typeof e?[e]:e;return document.title=[s,...n].filter((e=>!!e)).join(" | "),()=>{document.title=t}}),[e,s])}const z={form:"styles_form__cFFCH",field:"styles_field__5rpBk"};function M(e){let{className:s,style:t,onSubmit:n,children:l}=e;return(0,v.jsx)("form",{className:y(z.form,s),style:t,onSubmit:e=>{e.preventDefault(),n()},children:l})}function W(e){let{label:s,className:t,style:n,children:l}=e;return(0,v.jsxs)("label",{className:y(z.field,t),style:n,children:[(0,v.jsx)("span",{children:s}),l]})}function R(){D("\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f");const[e,s]=(0,f.useState)(""),t=(0,f.useRef)(null),n=(0,f.useRef)(null),i=function(e){const s=(0,l.useQueryClient)(),t=(0,l.useMutation)({mutationFn:E,onSuccess:e=>{s.setQueryData("user",(()=>e)),s.invalidateQueries("quests")},onError:s=>{null===e||void 0===e||e(s instanceof r?s.message:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437")}});return t}(s);return(0,v.jsxs)(O,{header:null,centered:!0,centeredPage:!0,gap:"2em",children:[(0,v.jsx)(C.rU,{to:"/",className:y(U.back,"material_symbols"),children:"arrow_back"}),(0,v.jsx)("h1",{children:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"}),e&&(0,v.jsx)("h3",{children:e}),i.isLoading&&(0,v.jsx)(P,{}),(0,v.jsxs)(M,{className:U.form,onSubmit:function(){var e,s;const l=(null===(e=t.current)||void 0===e?void 0:e.value)||"",r=(null===(s=n.current)||void 0===s?void 0:s.value)||"";i.mutate({login:l,password:r})},children:[(0,v.jsx)(W,{label:"\u041b\u043e\u0433\u0438\u043d",children:(0,v.jsx)("input",{ref:t,type:"text",name:"login",required:!0})}),(0,v.jsx)(W,{label:"\u041f\u0430\u0440\u043e\u043b\u044c",children:(0,v.jsx)("input",{ref:n,type:"password",name:"password",required:!0})}),(0,v.jsx)("button",{type:"submit",className:"button button_light button_small",disabled:"loading"==i.status,children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}const Y={root:"styles_root__h8xNs",title:"styles_title__+su+v",map:"styles_map__giu5H"},G=t.p+"static/media/map.b7c468d134662b591994.png",J={root:"styles_root__cV7H9"};function X(e){let{curPage:s}=e;return(0,v.jsxs)("div",{className:J.root,children:["map"!=s&&(0,v.jsx)(C.rU,{to:"/",children:"\u041a\u0430\u0440\u0442\u0430"}),"timetable"!=s&&(0,v.jsx)(C.rU,{to:"/timetable",children:"\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),"quest"!=s&&(0,v.jsx)(C.rU,{to:"/quest",children:"\u041a\u0432\u0435\u0441\u0442\u044b"}),"store"!=s&&(0,v.jsx)(C.rU,{to:"/store",children:"\u041c\u0430\u0433\u0430\u0437\u0438\u043d"})]})}function V(){return(0,v.jsxs)(O,{centeredPage:!0,gap:"1em",className:Y.root,footer:(0,v.jsx)(X,{curPage:"map"}),children:[(0,v.jsx)("h1",{className:Y.title,children:"Underparty"}),(0,v.jsx)("div",{className:Y.map,children:(0,v.jsx)("img",{src:G,alt:"\u041a\u0430\u0440\u0442\u0430"})})]})}const K={root:"styles_root__7P05R"},Z={root:"styles_root__O0923",hidden:"styles_hidden__eYJaf",open:"styles_open__35Vcu",popup:"styles_popup__L-0H0",header:"styles_header__o87wG",close:"styles_close__w0Yhz",body:"styles_body__t75Nd"};function $(e){let{children:s,open:t=!1,close:n,title:l="",closeOnOutclick:r=!0}=e;const i=(0,f.useRef)(null),[a,o]=(0,f.useState)(t),[c,d]=(0,f.useState)(!t);return(0,f.useEffect)((()=>{if(t){d(!1);const e=setTimeout((()=>o(!0)),100);return()=>clearTimeout(e)}o(!1);const e=setTimeout((()=>d(!0)),250);return()=>clearTimeout(e)}),[t]),(0,v.jsx)("div",{ref:i,className:y(Z.root,a&&Z.open,c&&Z.hidden),onClick:e=>{r&&e.target==i.current&&(null===n||void 0===n||n())},children:(0,v.jsxs)("div",{className:Z.popup,children:[(l||n)&&(0,v.jsxs)("div",{className:Z.header,children:[(0,v.jsx)("h3",{children:l}),n&&(0,v.jsx)("button",{className:Z.close,onClick:n})]}),(0,v.jsx)("div",{className:Z.body,children:s})]})})}function ee(){const[e,s]=(0,f.useState)(""),[t,n]=(0,f.useState)(""),l=(0,f.useRef)(null),r=(0,f.useRef)(null);return(0,v.jsxs)(O,{centered:!0,gap:"1rem",className:K.root,children:[(0,v.jsx)(C.rU,{to:"/users",children:"Users"}),(0,v.jsx)(C.rU,{to:"/log",children:"Log"}),(0,v.jsx)("button",{onClick:async()=>{s("Loading");try{const e=await fetch("/api/debug/log_errors"),t=await e.text();s(t),setTimeout((()=>{var e,s,t,n;return null===(e=l.current)||void 0===e||null===(s=e.parentElement)||void 0===s?void 0:s.scrollTo(0,null===(t=l.current)||void 0===t||null===(n=t.parentElement)||void 0===n?void 0:n.scrollHeight)}),150)}catch(e){s(JSON.stringify(e))}},children:"Log errors"}),(0,v.jsx)("button",{onClick:async()=>{n("Loading");try{const e=await fetch("/api/debug/log_info"),s=await e.text();n(s),setTimeout((()=>{var e,s,t,n;return null===(e=r.current)||void 0===e||null===(s=e.parentElement)||void 0===s?void 0:s.scrollTo(0,null===(t=r.current)||void 0===t||null===(n=t.parentElement)||void 0===n?void 0:n.scrollHeight)}),150)}catch(e){n(JSON.stringify(e))}},children:"Log requests"}),(0,v.jsx)($,{title:"logErrors",open:""!=e,close:()=>s(""),children:(0,v.jsx)("pre",{ref:l,children:e})}),(0,v.jsx)($,{title:"log",open:""!=t,close:()=>n(""),children:(0,v.jsx)("pre",{ref:r,children:t})})]})}const se={user:"styles_user__WUZvf",title:"styles_title__Gd1jL",toggle:"styles_toggle__qlIwC",toggleInp:"styles_toggleInp__fGE-7",userInfo:"styles_userInfo__vgBlw",operations:"styles_operations__MGBbv"};function te(){var e;D("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438");const s=(0,l.useQuery)("users",(async()=>await c("/api/users")));return(0,v.jsxs)(O,{centeredPage:!0,gap:8,styles:{fontFamily:"'PT Sans', Arial"},children:[s.isLoading&&(0,v.jsx)("h3",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),p(s),null===(e=s.data)||void 0===e?void 0:e.map((e=>(0,v.jsxs)("div",{className:se.user,children:[(0,v.jsx)("input",{type:"checkbox",className:se.toggleInp,id:"user".concat(e.id)}),(0,v.jsxs)("label",{className:se.title,htmlFor:"user".concat(e.id),children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{children:e.login}),(0,v.jsx)("div",{style:{color:"blue"},children:e.id}),(0,v.jsx)("div",{children:"|"}),(0,v.jsx)("div",{children:e.name})]}),(0,v.jsxs)("div",{children:[e.deleted&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:{color:"tomato"},children:"deleted"}),(0,v.jsx)("div",{children:"|"})]}),(0,v.jsx)("span",{children:e.roles.join(", ")}),(0,v.jsx)("div",{className:se.toggle})]})]}),(0,v.jsx)("div",{className:se.userInfo,children:(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{children:"Operations"}),(0,v.jsx)("div",{className:se.operations,children:e.operations.map(((e,s)=>(0,v.jsx)("div",{children:ne(e)},s)))})]})})]},e.id)))]})}function ne(e){const s={page:"#990099",add:"#008000",get:"#008000",change:"#006fb3",delete:"#b30000"};for(const t in s)if(e.startsWith(t))return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{style:{color:s[t]},children:t}),(0,v.jsx)("span",{children:e.slice(t.length)})]});return(0,v.jsx)("span",{children:e})}function le(e){const s=e;return s.date=new Date(e.date),s}function re(e,s){return"".concat(e).padStart(s,"0")}function ie(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(e){return e?arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"".concat(e.getFullYear(),".").concat(re(e.getMonth()+1,2),".").concat(re(e.getDate(),2)):"".concat(re(e.getDate(),2),".").concat(re(e.getMonth()+1,2),".").concat(e.getFullYear()):""}(e,arguments.length>2&&void 0!==arguments[2]&&arguments[2])+" "+function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t="".concat(re(e.getHours(),2),":").concat(re(e.getMinutes(),2));return s?t+":".concat(re(e.getSeconds(),2)):t}(e,s)}const ae={table:"styles_table__QLr-h",changesCell:"styles_changesCell__0wQDJ",changes:"styles_changes__EyS9f",btn:"styles_btn__H7b72"};function oe(){var e;D("Log");const s=(0,l.useQuery)("log",(async()=>(await c("/api/debug/log")).map(le)));return(0,v.jsxs)(O,{centeredPage:!0,styles:{fontFamily:"'PT Sans', Arial"},children:[s.isFetching&&(0,v.jsx)("h3",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),p(s),!s.isFetching&&(0,v.jsx)("button",{className:ae.btn,onClick:()=>s.refetch(),children:"Update"}),(0,v.jsxs)("table",{className:ae.table,children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{style:{minWidth:"9.5em"},children:"Date"}),(0,v.jsx)("th",{style:{minWidth:"4em"},children:"Action"}),(0,v.jsx)("th",{style:{minWidth:"9.5em"},children:"Table[id]"}),(0,v.jsx)("th",{children:"User[id]"}),(0,v.jsx)("th",{style:{width:"18em"},children:"Changes"})]})}),(0,v.jsx)("tbody",{children:null===(e=s.data)||void 0===e?void 0:e.map((e=>(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:ie(e.date,!0,!0)}),(0,v.jsx)("td",{children:ce(e.actionCode)}),(0,v.jsxs)("td",{children:[e.tableName,"[",e.recordId,"]"]}),(0,v.jsxs)("td",{children:[e.userName," [",e.userId,"]"]}),(0,v.jsx)("td",{className:ae.changesCell,children:(0,v.jsxs)("div",{className:ae.changes,children:[(0,v.jsx)("input",{type:"checkbox",className:ae.toggleInp,id:"item".concat(e.id)}),(0,v.jsx)("div",{children:e.changes.map((e=>(0,v.jsxs)("div",{children:[e[0],": ",JSON.stringify(e[1])," ","->"," ",JSON.stringify(e[2])]},e[0])))}),e.changes.length>0&&(0,v.jsx)("label",{className:ae.btn,htmlFor:"item".concat(e.id),children:e.changes.length})]})})]},e.id)))})]})]})}function ce(e){return(0,v.jsx)("span",{style:{color:{added:"#008000",deleted:"#b30000",updated:"#006fb3",restored:"#990099"}[e]},children:e})}const de={back:"styles_back__Qx6+G",auth:"styles_auth__p4qSS",login:"styles_login__HG64A"},ue="data:image/png;base64,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";function he(){return D("\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),(0,v.jsxs)(O,{header:null,centered:!0,centeredPage:!0,gap:"2em",children:[(0,v.jsx)(C.rU,{to:"/",className:y(de.back,"material_symbols"),children:"arrow_back"}),(0,v.jsx)(C.rU,{to:"/auth",className:de.auth}),(0,v.jsx)("h1",{children:"Underparty"}),(0,v.jsxs)("button",{className:de.login,children:[(0,v.jsx)("span",{children:"\u0412\u043e\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437"}),(0,v.jsx)("img",{src:ue,alt:"VK"})]})]})}const _e={root:"styles_root__Rm-tG",input:"styles_input__2tNlg",password:"styles_password__Om-1z"};function me(){var e,s,t;const n=u(),r=(0,f.useRef)(null),[i,o]=(0,f.useState)(!1),c=function(e){const s=(0,l.useQueryClient)();return(0,l.useMutation)({mutationFn:async e=>(await a("/api/user/change_name",e),e),onSuccess:t=>{var n;"success"==(null===(n=s.getQueryState("user"))||void 0===n?void 0:n.status)&&s.setQueryData("user",(e=>({...e,name:t.name}))),null===e||void 0===e||e()}})}();return(0,v.jsx)(O,{centered:!0,gap:"1rem",children:(0,v.jsxs)("div",{className:_e.root,children:[p(c),c.isLoading&&(0,v.jsx)(P,{}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{children:"\u0418\u043c\u044f"}),(0,v.jsx)("div",{children:(0,v.jsx)("input",{type:"text",ref:r,defaultValue:null===(e=n.data)||void 0===e?void 0:e.name,disabled:!i,className:_e.input})}),(0,v.jsxs)("div",{children:[!i&&(0,v.jsx)("button",{onClick:()=>o(!0),className:"button button_small",children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"}),i&&(0,v.jsx)("button",{onClick:()=>{var e;o(!1),r.current&&(r.current.value=(null===(e=n.data)||void 0===e?void 0:e.name)||"")},className:"button button_small",children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),i&&(0,v.jsx)("button",{onClick:()=>{o(!1),r.current&&c.mutate({name:r.current.value})},className:"button button_small",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{children:"\u041b\u043e\u0433\u0438\u043d"}),null===(s=n.data)||void 0===s?void 0:s.login]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{children:"\u0420\u043e\u043b\u0438"}),null===(t=n.data)||void 0===t?void 0:t.roles.map(((e,s)=>(0,v.jsx)("div",{children:e},s)))]})]})})}const xe={root:"styles_root__E5y+5",title:"styles_title__3QqY9",map:"styles_map__bsZaz"},fe=t.p+"static/media/timetable.9dbcb4664b2137d4198b.png";function je(){return(0,v.jsxs)(O,{centeredPage:!0,gap:"1em",className:xe.root,footer:(0,v.jsx)(X,{curPage:"timetable"}),children:[(0,v.jsx)("h1",{className:xe.title,children:"Underparty"}),(0,v.jsx)("div",{className:xe.map,children:(0,v.jsx)("img",{src:fe,alt:"\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})})]})}function ve(){return(0,l.useQuery)("quests",(async()=>await c("/api/quests")))}function ge(e,s){return(0,l.useMutation)({mutationFn:async e=>await d("/api/quest_complete",e),onSuccess:e,onError:s})}const pe={root:"styles_root__CEdGL",body:"styles_body__o-6ZK",bottom:"styles_bottom__zkZn6",title:"styles_title__6wHPv",btnQr:"styles_btnQr__94tox",quests:"styles_quests__58NxQ",quest:"styles_quest__65tbN"};var Ae=t(741);function ye(e){let{code:s,scale:t=10,margin:n=1,color:l="#000000",colorBg:r="#ffffff"}=e;const[i,a]=(0,f.useState)("");return(0,f.useEffect)((()=>{s&&(a(""),Ae.toDataURL(s,{errorCorrectionLevel:"H",scale:t,margin:n,color:{dark:l,light:r}},((e,s)=>a(s))))}),[s,l,t,n,r]),(0,v.jsx)("img",{src:i,alt:s,style:{width:"100%"}})}function be(){var e,s;const t=u(),n=function(){const e=(0,l.useQueryClient)();return()=>e.invalidateQueries("quests")}(),[r,i]=(0,f.useState)(!1),a=ve();return(0,v.jsxs)(O,{centeredPage:!0,gap:"1em",className:pe.root,footer:(0,v.jsx)(X,{curPage:"quest"}),children:[a.isFetching&&(0,v.jsx)(P,{}),(0,v.jsxs)("div",{className:pe.body,children:[(0,v.jsx)("h1",{className:pe.title,children:"Underparty"}),(0,v.jsxs)("div",{className:pe.quests,children:[p(a),null===a||void 0===a||null===(e=a.data)||void 0===e?void 0:e.map((e=>(0,v.jsxs)("div",{className:pe.quest,children:[(0,v.jsx)("span",{children:e.name}),e.completed?(0,v.jsx)("span",{className:"material_symbols",children:"done"}):(0,v.jsxs)("span",{children:[e.reward,"G"]})]},e.id)))]})]}),(0,v.jsx)("div",{className:pe.bottom,children:(0,v.jsx)("button",{className:pe.btnQr,onClick:()=>i(!0),children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043a\u0432\u0435\u0441\u0442!"})}),(0,v.jsx)($,{title:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u043a\u0432\u0435\u0441\u0442\u0430",open:r,close:()=>{i(!1),n()},children:null!==t&&void 0!==t&&null!==(s=t.data)&&void 0!==s&&s.auth?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ye,{code:"user_".concat(t.data.id),colorBg:"#ffffff00",scale:13}),(0,v.jsx)("h3",{children:"\u041f\u043e\u043a\u0430\u0436\u0438\u0442\u0435 qr-\u043a\u043e\u0434 \u043a\u0432\u0435\u0441\u0442\u043e\u0432\u0438\u043a\u0443"})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("p",{children:"\u0414\u043b\u044f \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f \u043a\u0432\u0435\u0441\u0442\u043e\u0432 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u043e\u0439\u0442\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443."}),(0,v.jsx)("p",{children:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0432\u0445\u043e\u0434\u0430 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0432 \u043f\u0440\u0430\u0432\u043e\u043c \u0432\u0435\u0440\u0445\u043d\u0435\u043c \u0443\u0433\u043b\u0443."})]})})]})}function He(e,s){return(0,l.useMutation)({mutationFn:async e=>await d("/api/store_sell_check",e),onSuccess:(s,t)=>{s.itemId=t.itemId,s.playerId=t.userId,null===e||void 0===e||e(s)},onError:s})}const Ne={root:"styles_root__0CejE",title:"styles_title__u3Xt9",items:"styles_items__n-Fvc",item:"styles_item__zIxt2",item__img:"styles_item__img__r3iEr",item__desc:"styles_item__desc__wbcAM"};function we(){var e,s,t;const n=u(),r=function(){const e=(0,l.useQueryClient)();return()=>e.invalidateQueries("user")}(),[i,a]=(0,f.useState)(!1),[o,d]=(0,f.useState)(null),h=(0,l.useQuery)("storeItems",(async()=>await c("/api/store_items")));return(0,v.jsxs)(O,{centeredPage:!0,gap:"1em",className:Ne.root,footer:(0,v.jsx)(X,{curPage:"store"}),children:[h.isLoading&&(0,v.jsx)(P,{}),(0,v.jsx)("h1",{className:Ne.title,children:"Underparty"}),(0,v.jsxs)("div",{className:Ne.items,children:[p(h),null===h||void 0===h||null===(e=h.data)||void 0===e?void 0:e.map((e=>(0,v.jsxs)("button",{className:Ne.item,onClick:()=>{d(e),a(!0)},children:[(0,v.jsx)("div",{className:Ne.item__img,children:(0,v.jsx)("img",{src:e.img,alt:"\u0422\u043e\u0432\u0430\u0440"})}),(0,v.jsxs)("div",{className:Ne.item__desc,children:[(0,v.jsx)("span",{children:e.name}),(0,v.jsxs)("span",{children:[e.price," G"]})]})]},e.id)))]}),(0,v.jsx)($,{title:"\u041f\u043e\u043a\u0443\u043f\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u0430",open:i,close:()=>{var e;a(!1),null===(e=n.data)||void 0===e||!e.auth||n.data.balance<((null===o||void 0===o?void 0:o.price)||0)||r()},children:null!==n&&void 0!==n&&null!==(s=n.data)&&void 0!==s&&s.auth?(0,v.jsx)(v.Fragment,{children:n.data.balance<((null===o||void 0===o?void 0:o.price)||0)?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("h2",{style:{marginBottom:8},children:"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u044d\u0442\u043e\u0442 \u0442\u043e\u0432\u0430\u0440 \u0432\u0430\u043c \u043d\u0435 \u043f\u043e \u043a\u0430\u0440\u043c\u0430\u043d\u0443"}),(0,v.jsxs)("h2",{className:Ne.item__desc,children:[(0,v.jsx)("span",{children:null===o||void 0===o?void 0:o.name}),(0,v.jsxs)("span",{children:[null===o||void 0===o?void 0:o.price," G"]})]}),(0,v.jsxs)("h2",{className:Ne.item__desc,style:{marginBottom:8},children:[(0,v.jsx)("span",{children:"\u0412\u0430\u043c \u043d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442:"}),(0,v.jsxs)("span",{children:[((null===o||void 0===o?void 0:o.price)||0)-n.data.balance," G"]})]}),(0,v.jsx)("h3",{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0439\u0442\u0435 \u043a\u0432\u0435\u0441\u0442\u044b \u0438 \u0440\u0430\u0437\u0431\u043e\u0433\u0430\u0442\u0435\u0435\u0442\u0435!"})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ye,{code:"user_".concat(null===(t=n.data)||void 0===t?void 0:t.id,";item_").concat(null===o||void 0===o?void 0:o.id),colorBg:"#ffffff00",scale:13}),(0,v.jsxs)("h2",{className:Ne.item__desc,children:[(0,v.jsx)("span",{children:null===o||void 0===o?void 0:o.name}),(0,v.jsxs)("span",{children:[null===o||void 0===o?void 0:o.price," G"]})]}),(0,v.jsx)("h3",{children:"\u041f\u043e\u043a\u0430\u0436\u0438\u0442\u0435 qr-\u043a\u043e\u0434 \u043f\u0440\u043e\u0434\u0430\u0432\u0446\u0443"}),(0,v.jsx)("h4",{children:"\u0415\u0441\u043b\u0438 \u0431\u0430\u043b\u0430\u043d\u0441 \u043d\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u043b\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043f\u0430\u0440\u0443 \u0441\u0435\u043a\u0443\u043d\u0434 - \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443"})]})}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("p",{children:"\u0414\u043b\u044f \u0441\u043e\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u043f\u043e\u043a\u0443\u043f\u043e\u043a \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u043e\u0439\u0442\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443."}),(0,v.jsx)("p",{children:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0432\u0445\u043e\u0434\u0430 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0432 \u043f\u0440\u0430\u0432\u043e\u043c \u0432\u0435\u0440\u0445\u043d\u0435\u043c \u0443\u0433\u043b\u0443."})]})})]})}const ke={root:"styles_root__91Sa8",title:"styles_title__Duk4+"},Se={root:"styles_root__QdJnV",msg:"styles_msg__plnAU",msg_visible:"styles_msg_visible__G0rDm",msg_dimmed:"styles_msg_dimmed__0Xs60",bar:"styles_bar__VuYbs",bar_full:"styles_bar_full__poY0b"},Ce={error:"styles_error__EtK3I",video:"styles_video__b88Zl"},Ie=t.p+"static/media/beep.38f199e084efe5461ffd.mp3";var Ee=t(1096);let Qe=e=>{},Le=()=>{},Pe=!1,qe=null,Fe=null;function Oe(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;if(!Fe){qe=document.createElement("div"),document.body.appendChild(qe),qe.style.display="flex",qe.style.backgroundColor="black";const e=document.createElement("video");qe.appendChild(e),Fe=new Ee.Z(e,(e=>Qe(e.data)),{highlightScanRegion:!0,maxScansPerSecond:10})}(0,f.useEffect)((()=>(setTimeout((()=>{var e;return null===(e=Fe)||void 0===e?void 0:e.start().catch((()=>{setTimeout((()=>{var e;null===(e=Fe)||void 0===e||e.start().catch((()=>Le()))}),250)}))}),100),()=>{var e;null===(e=Fe)||void 0===e||e.stop()})),[]);const[t,n]=(0,f.useState)(!1),[l,r]=(0,f.useState)(""),[i,a]=(0,f.useState)(Pe),o=function(e){const[s]=(0,f.useState)((()=>{const s=new Audio(e);return s.preload="auto",s}));return()=>{s.currentTime=0,s.play()}}(Ie);return Qe=l=>{t||e||(r(l),n(!0),o(),setTimeout((()=>{r(""),n(!1)}),s))},Le=()=>{Pe=!0,a(!0)},i?{scanned:l,scanner:(0,v.jsxs)("div",{className:Ce.error,children:[(0,v.jsx)("h1",{children:"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043a\u0430\u043c\u0435\u0440\u0435"}),(0,v.jsx)("p",{children:"\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u043c\u0435\u0440\u044b \u044d\u0442\u043e\u043c\u0443 \u0441\u0430\u0439\u0442\u0443 \u0438 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0443, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0442\u0435."}),(0,v.jsx)("p",{children:"\u041f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443."})]})}:{scanned:l,scanner:(0,v.jsx)("div",{children:(0,v.jsx)("div",{ref:e=>{e&&(e.innerHTML="",e.appendChild(qe))},className:Ce.video})})}}function Te(e){let{useMutation:s,onScan:t,formatMsg:n,onRes:l,className:r,pause:i}=e;const[a,o]=(0,f.useState)(""),[c,d]=(0,f.useState)(""),u=(0,f.useRef)(null),h=s((e=>{o(n(e)),d(""),x(),null===l||void 0===l||l(e)}),(e=>{o(""),d(g(e)),x()})),{scanned:_,scanner:m}=Oe(!h.isIdle||i);function x(){var e;setTimeout((()=>h.reset()),1e3),null===(e=u.current)||void 0===e||e.classList.add(Se.bar_full),setTimeout((()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.classList.remove(Se.bar_full)}),100)}return(0,f.useEffect)((()=>{if(""==_||!h.isIdle)return;o(""),d("");const e=t(_);e?h.mutate(e):d("\u041d\u0435 \u043e\u043f\u043e\u0437\u043d\u0430\u043d\u043e")}),[_]),(0,v.jsxs)("div",{className:y(Se.root,r),children:[h.isLoading&&(0,v.jsx)(P,{}),m,(0,v.jsxs)("div",{className:y(Se.msg,(a||c)&&Se.msg_visible,(a||c)&&h.isIdle&&Se.msg_dimmed),children:[(0,v.jsx)("h2",{children:a}),(0,v.jsx)("h2",{children:c})]}),(0,v.jsx)("div",{ref:u,className:Se.bar})]})}function Be(){var e,s;const t=(0,n.UO)(),l=parseInt(t.questId,10),r=ve();return(0,v.jsxs)(O,{className:ke.root,children:[r.isLoading&&(0,v.jsx)(P,{}),(0,v.jsxs)("div",{className:ke.title,children:[(0,v.jsx)("h2",{children:null===(e=r.data)||void 0===e||null===(s=e.find((e=>e.id==l)))||void 0===s?void 0:s.name}),(0,v.jsx)("h3",{children:"\u041f\u0440\u043e\u0441\u043a\u0430\u043d\u0438\u0440\u0443\u0439\u0442\u0435 qr-\u043a\u043e\u0434 \u043f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044f, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0435\u043c\u0443 \u044d\u0442\u043e\u0442 \u043a\u0432\u0435\u0441\u0442."}),p(r)]}),(0,v.jsx)(Te,{useMutation:ge,onScan:e=>{if(!e.startsWith("user_"))return null;const s=parseInt(e.slice(5),10);return isNaN(s)?null:{userId:s,questId:l}},formatMsg:e=>({ok:"\u041a\u0432\u0435\u0441\u0442 \u0437\u0430\u0447\u0442\u0451\u043d \u0434\u043b\u044f ".concat(e.player),already_done:"".concat(e.player," \u0443\u0436\u0435 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u043b \u044d\u0442\u043e\u0442 \u043a\u0432\u0435\u0441\u0442"),no_player:"\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"}[e.res]||e.res)})]})}const Ue={btn:"styles_btn__w12Ul"};function De(){return(0,v.jsxs)(O,{centered:!0,gap:"0.5rem",children:[m("page_scanner_quest")&&(0,v.jsx)(C.rU,{to:"/scanner_quest",className:Ue.btn,children:"\u0414\u043b\u044f \u043a\u0432\u0435\u0441\u0442\u043e\u0432\u0438\u043a\u043e\u0432"}),m("page_scanner_store")&&(0,v.jsx)(C.rU,{to:"/scanner_store",className:Ue.btn,children:"\u0414\u043b\u044f \u043f\u0440\u043e\u0434\u0430\u0432\u0446\u043e\u0432"})]})}const ze={root:"styles_root__d985G",quests:"styles_quests__TBzNh"};function Me(){var e;const s=ve();return(0,v.jsxs)(O,{centered:!0,gap:"1rem",className:ze.root,children:[s.isLoading&&(0,v.jsx)(P,{}),p(s),(0,v.jsx)("h2",{children:"\u041a\u0430\u043a\u043e\u0439 \u043a\u0432\u0435\u0441\u0442 \u0432\u044b \u043f\u0440\u043e\u0432\u043e\u0434\u0438\u0442\u0435?"}),(0,v.jsx)("div",{className:ze.quests,children:null===(e=s.data)||void 0===e?void 0:e.map((e=>(0,v.jsx)(C.rU,{to:"/scanner_quest/"+e.id,children:e.name},e.id)))})]})}const We={root:"styles_root__jLTkZ",title:"styles_title__oIrEy",item:"styles_item__rXv3s",item__img:"styles_item__img__O-P1T",item__desc:"styles_item__desc__zxJ9K",btns:"styles_btns__9aQ2N",btn_deny:"styles_btn_deny__7EPCy",btn_ok:"styles_btn_ok__WFDzm"};function Re(){const[e,s]=(0,f.useState)(!1),[t,n]=(0,f.useState)(!1),[r,i]=(0,f.useState)(null),a=function(e,s){return(0,l.useMutation)({mutationFn:async e=>await d("/api/store_sell",e),onSuccess:e,onError:s})}(c,c);function o(){s(!1),n(!1)}function c(){n(!1)}return(0,v.jsxs)(O,{className:We.root,children:[a.isLoading&&(0,v.jsx)(P,{}),(0,v.jsx)("div",{className:We.title,children:(0,v.jsx)("h3",{children:"\u041f\u0440\u043e\u0441\u043a\u0430\u043d\u0438\u0440\u0443\u0439\u0442\u0435 qr-\u043a\u043e\u0434 \u043f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044f, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0434\u0430\u0442\u044c \u0435\u043c\u0443 \u0442\u043e\u0432\u0430\u0440."})}),(0,v.jsx)(Te,{useMutation:He,pause:e,onScan:e=>{const s=e.split(";");if(2!=s.length)return null;const[t,n]=s;if(!t.startsWith("user_")||!n.startsWith("item_"))return null;const l=parseInt(t.slice(5),10),r=parseInt(n.slice(5),10);return isNaN(l)||isNaN(r)?null:{userId:l,itemId:r}},formatMsg:e=>{var s;return null!==(s={ok:"",no_item:"\u0422\u043e\u0432\u0430\u0440 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d",no_player:"\u041f\u043e\u043a\u0443\u043f\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d",no_money:"\u0423 ".concat(e.player," \u043d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u0441\u0440\u0435\u0434\u0441\u0442\u0432")}[e.res])&&void 0!==s?s:e.res},onRes:e=>{"ok"==e.res&&(s(!0),n(!0),i(e))}}),(0,v.jsxs)($,{title:"\u041f\u0440\u043e\u0434\u0430\u0436\u0430 \u0442\u043e\u0432\u0430\u0440\u0430",open:t,closeOnOutclick:!1,close:o,children:[(0,v.jsxs)("h3",{children:[null===r||void 0===r?void 0:r.player," \u0445\u043e\u0447\u0435\u0442 \u043a\u0443\u043f\u0438\u0442\u044c:"]}),(0,v.jsxs)("div",{className:We.item,children:[(0,v.jsx)("div",{className:We.item__img,children:(0,v.jsx)("img",{src:null===r||void 0===r?void 0:r.item.img,alt:"\u0422\u043e\u0432\u0430\u0440"})}),(0,v.jsxs)("div",{className:We.item__desc,children:[(0,v.jsx)("span",{children:null===r||void 0===r?void 0:r.item.name}),(0,v.jsxs)("span",{children:[null===r||void 0===r?void 0:r.item.price," G"]})]})]}),(0,v.jsx)("p",{children:"\u0412\u044b\u0434\u0430\u0439\u0442\u0435 \u0442\u043e\u0432\u0430\u0440 \u0438 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u043f\u043e\u043a\u0443\u043f\u043a\u0443:"}),(0,v.jsxs)("div",{className:We.btns,children:[(0,v.jsx)("button",{className:We.btn_deny,onClick:o,children:"\u041e\u0442\u043a\u043b\u043e\u043d\u0438\u0442\u044c"}),(0,v.jsx)("button",{className:We.btn_ok,onClick:()=>{a.mutate({userId:r.playerId,itemId:r.itemId})},children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c"})]})]}),(0,v.jsxs)($,{title:"\u041f\u0440\u043e\u0434\u0430\u0436\u0430 \u0442\u043e\u0432\u0430\u0440\u0430",open:a.isSuccess||a.isError,close:function(){a.reset(),s(!1)},children:[a.isSuccess&&("ok"==a.data.res?(0,v.jsxs)("h2",{children:["\u0422\u043e\u0432\u0430\u0440 ",a.data.item," \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u0440\u043e\u0434\u0430\u043d \u043f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044e ",a.data.player]}):(0,v.jsxs)("h2",{children:["\u0423 ",a.data.player," \u043d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u0441\u0440\u0435\u0434\u0441\u0442\u0432 \u043d\u0430 \u043f\u043e\u043a\u0443\u043f\u043a\u0443 ",a.data.item]})),p(a)]})]})}function Ye(){var e,s;const t=u();function l(e,s,l){var r;return(0,v.jsx)(n.AW,{path:s,element:null!==(r=t.data)&&void 0!==r&&r.auth?null==e||_(t,e)?l:(0,v.jsx)(B,{}):(0,v.jsx)(n.Fg,{to:"/auth"})})}return(0,v.jsxs)("div",{className:"root",children:[(0,v.jsx)(j,{}),(0,v.jsx)(N,{}),t.isLoading&&(0,v.jsx)(x.Z,{}),p(t),t.isSuccess&&(0,v.jsxs)(n.Z5,{children:[(0,v.jsx)(n.AW,{path:"/",element:(0,v.jsx)(V,{})}),(0,v.jsx)(n.AW,{path:"/login",element:null!==(e=t.data)&&void 0!==e&&e.auth?(0,v.jsx)(n.Fg,{to:"/"}):(0,v.jsx)(he,{})}),(0,v.jsx)(n.AW,{path:"/auth",element:null!==(s=t.data)&&void 0!==s&&s.auth?(0,v.jsx)(n.Fg,{to:"/"}):(0,v.jsx)(R,{})}),(0,v.jsx)(n.AW,{path:"/timetable",element:(0,v.jsx)(je,{})}),(0,v.jsx)(n.AW,{path:"/quest",element:(0,v.jsx)(be,{})}),(0,v.jsx)(n.AW,{path:"/store",element:(0,v.jsx)(we,{})}),l(null,"/profile",(0,v.jsx)(me,{})),l("page_worker","/worker",(0,v.jsx)(De,{})),l("page_scanner_quest","/scanner_quest",(0,v.jsx)(Me,{})),l("page_scanner_quest","/scanner_quest/:questId",(0,v.jsx)(Be,{})),l("page_scanner_store","/scanner_store",(0,v.jsx)(Re,{})),l("page_debug","/debug",(0,v.jsx)(ee,{})),l("page_debug","/log",(0,v.jsx)(oe,{})),l("page_users","/users",(0,v.jsx)(te,{})),(0,v.jsx)(n.AW,{path:"*",element:(0,v.jsx)(T,{})})]})]})}}}]);
//# sourceMappingURL=303.c59ac1b1.chunk.js.map